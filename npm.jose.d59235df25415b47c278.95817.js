(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["npm.jose"],{f421:function(e,t,r){"use strict";r.r(t),r.d(t,"compactDecrypt",(function(){return ua})),r.d(t,"flattenedDecrypt",(function(){return ta})),r.d(t,"generalDecrypt",(function(){return ha})),r.d(t,"GeneralEncrypt",(function(){return mo})),r.d(t,"compactVerify",(function(){return zo})),r.d(t,"flattenedVerify",(function(){return Mo})),r.d(t,"generalVerify",(function(){return ei})),r.d(t,"jwtVerify",(function(){return Oi})),r.d(t,"jwtDecrypt",(function(){return Ki})),r.d(t,"CompactEncrypt",(function(){return Mi})),r.d(t,"FlattenedEncrypt",(function(){return ro})),r.d(t,"CompactSign",(function(){return oc})),r.d(t,"FlattenedSign",(function(){return Zi})),r.d(t,"GeneralSign",(function(){return hc})),r.d(t,"SignJWT",(function(){return Jc})),r.d(t,"EncryptJWT",(function(){return eu})),r.d(t,"calculateJwkThumbprint",(function(){return au})),r.d(t,"calculateJwkThumbprintUri",(function(){return iu})),r.d(t,"EmbeddedJWK",(function(){return du})),r.d(t,"createLocalJWKSet",(function(){return Du})),r.d(t,"createRemoteJWKSet",(function(){return as})),r.d(t,"jwksCache",(function(){return ts})),r.d(t,"experimental_jwksCache",(function(){return os})),r.d(t,"UnsecuredJWT",(function(){return bs})),r.d(t,"exportPKCS8",(function(){return Ta})),r.d(t,"exportSPKI",(function(){return Ka})),r.d(t,"exportJWK",(function(){return Ja})),r.d(t,"importSPKI",(function(){return Vr})),r.d(t,"importPKCS8",(function(){return Yr})),r.d(t,"importX509",(function(){return Xr})),r.d(t,"importJWK",(function(){return Qr})),r.d(t,"decodeProtectedHeader",(function(){return Ps})),r.d(t,"decodeJwt",(function(){return js})),r.d(t,"errors",(function(){return n})),r.d(t,"generateKeyPair",(function(){return Ds})),r.d(t,"generateSecret",(function(){return Bs})),r.d(t,"base64url",(function(){return a})),r.d(t,"cryptoRuntime",(function(){return Fs}));var n={};r.r(n),r.d(n,"JOSEError",(function(){return B})),r.d(n,"JWTClaimValidationFailed",(function(){return G})),r.d(n,"JWTExpired",(function(){return L})),r.d(n,"JOSEAlgNotAllowed",(function(){return F})),r.d(n,"JOSENotSupported",(function(){return V})),r.d(n,"JWEDecryptionFailed",(function(){return z})),r.d(n,"JWEInvalid",(function(){return X})),r.d(n,"JWSInvalid",(function(){return $})),r.d(n,"JWTInvalid",(function(){return Y})),r.d(n,"JWKInvalid",(function(){return q})),r.d(n,"JWKSInvalid",(function(){return Q})),r.d(n,"JWKSNoMatchingKey",(function(){return Z})),r.d(n,"JWKSMultipleMatchingKeys",(function(){return ee})),r.d(n,"JWKSTimeout",(function(){return te})),r.d(n,"JWSSignatureVerificationFailed",(function(){return re}));var a={};r.r(a),r.d(a,"encode",(function(){return ws})),r.d(a,"decode",(function(){return ms}));var o=crypto,i=function(e){return e instanceof CryptoKey};function c(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){c(o,n,a,i,u,"next",e)}function u(e){c(o,n,a,i,u,"throw",e)}i(void 0)}))}}var s=function(){var e=u(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n="SHA-".concat(t.slice(-3)),e.t0=Uint8Array,e.next=4,o.subtle.digest(n,r);case 4:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),p=s;function f(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){f(o,n,a,i,c,"next",e)}function c(e){f(o,n,a,i,c,"throw",e)}i(void 0)}))}}var d=new TextEncoder,y=new TextDecoder,h=Math.pow(2,32);function v(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=t.reduce((function(e,t){var r=t.length;return e+r}),0),a=new Uint8Array(n),o=0,i=0,c=t;i<c.length;i++){var u=c[i];a.set(u,o),o+=u.length}return a}function b(e,t){return v(d.encode(e),new Uint8Array([0]),t)}function w(e,t,r){if(t<0||t>=h)throw new RangeError("value must be >= 0 and <= ".concat(h-1,". Received ").concat(t));e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function m(e){var t=Math.floor(e/h),r=e%h,n=new Uint8Array(8);return w(n,t,0),w(n,r,4),n}function g(e){var t=new Uint8Array(4);return w(t,e),t}function k(e){return v(g(e.length),e)}function S(e,t,r){return A.apply(this,arguments)}function A(){return A=l(regeneratorRuntime.mark((function e(t,r,n){var a,o,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=Math.ceil((r>>3)/32),o=new Uint8Array(32*a),i=0;case 3:if(!(i<a)){e.next=17;break}return c=new Uint8Array(4+t.length+n.length),c.set(g(i+1)),c.set(t,4),c.set(n,4+t.length),e.t0=o,e.next=11,p("sha256",c);case 11:e.t1=e.sent,e.t2=32*i,e.t0.set.call(e.t0,e.t1,e.t2);case 14:i++,e.next=3;break;case 17:return e.abrupt("return",o.slice(0,r>>3));case 18:case"end":return e.stop()}}),e)}))),A.apply(this,arguments)}var E=function(e){var t=e;"string"===typeof t&&(t=d.encode(t));for(var r=32768,n=[],a=0;a<t.length;a+=r)n.push(String.fromCharCode.apply(null,t.subarray(a,a+r)));return btoa(n.join(""))},x=function(e){return E(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},O=function(e){for(var t=atob(e),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r},P=function(e){var t=e;t instanceof Uint8Array&&(t=y.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return O(t)}catch(r){throw new TypeError("The input to be decoded is not correctly encoded.")}};function j(e){return j="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t,r){return t&&_(e.prototype,t),r&&_(e,r),e}function H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}function K(e){var t=D();return function(){var r,n=N(e);if(t){var a=N(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return W(this,r)}}function W(e,t){if(t&&("object"===j(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return T(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e){var t="function"===typeof Map?new Map:void 0;return I=function(e){if(null===e||!U(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return J(e,arguments,N(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),M(r,e)},I(e)}function J(e,t,r){return J=D()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var a=Function.bind.apply(e,n),o=new a;return r&&M(o,r.prototype),o},J.apply(null,arguments)}function D(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function U(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function M(e,t){return M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},M(e,t)}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}var B=function(e){C(r,e);var t=K(r);function r(e,n){var a,o;return H(this,r),o=t.call(this,e,n),o.code="ERR_JOSE_GENERIC",o.name=o.constructor.name,null===(a=Error.captureStackTrace)||void 0===a||a.call(Error,T(o),o.constructor),o}return R(r)}(I(Error));B.code="ERR_JOSE_GENERIC";var G=function(e){C(r,e);var t=K(r);function r(e,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";return H(this,r),a=t.call(this,e,{cause:{claim:o,reason:i,payload:n}}),a.code="ERR_JWT_CLAIM_VALIDATION_FAILED",a.claim=o,a.reason=i,a.payload=n,a}return R(r)}(B);G.code="ERR_JWT_CLAIM_VALIDATION_FAILED";var L=function(e){C(r,e);var t=K(r);function r(e,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";return H(this,r),a=t.call(this,e,{cause:{claim:o,reason:i,payload:n}}),a.code="ERR_JWT_EXPIRED",a.claim=o,a.reason=i,a.payload=n,a}return R(r)}(B);L.code="ERR_JWT_EXPIRED";var F=function(e){C(r,e);var t=K(r);function r(){var e;return H(this,r),e=t.apply(this,arguments),e.code="ERR_JOSE_ALG_NOT_ALLOWED",e}return R(r)}(B);F.code="ERR_JOSE_ALG_NOT_ALLOWED";var V=function(e){C(r,e);var t=K(r);function r(){var e;return H(this,r),e=t.apply(this,arguments),e.code="ERR_JOSE_NOT_SUPPORTED",e}return R(r)}(B);V.code="ERR_JOSE_NOT_SUPPORTED";var z=function(e){C(r,e);var t=K(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"decryption operation failed",a=arguments.length>1?arguments[1]:void 0;return H(this,r),e=t.call(this,n,a),e.code="ERR_JWE_DECRYPTION_FAILED",e}return R(r)}(B);z.code="ERR_JWE_DECRYPTION_FAILED";var X=function(e){C(r,e);var t=K(r);function r(){var e;return H(this,r),e=t.apply(this,arguments),e.code="ERR_JWE_INVALID",e}return R(r)}(B);X.code="ERR_JWE_INVALID";var $=function(e){C(r,e);var t=K(r);function r(){var e;return H(this,r),e=t.apply(this,arguments),e.code="ERR_JWS_INVALID",e}return R(r)}(B);$.code="ERR_JWS_INVALID";var Y=function(e){C(r,e);var t=K(r);function r(){var e;return H(this,r),e=t.apply(this,arguments),e.code="ERR_JWT_INVALID",e}return R(r)}(B);Y.code="ERR_JWT_INVALID";var q=function(e){C(r,e);var t=K(r);function r(){var e;return H(this,r),e=t.apply(this,arguments),e.code="ERR_JWK_INVALID",e}return R(r)}(B);q.code="ERR_JWK_INVALID";var Q=function(e){C(r,e);var t=K(r);function r(){var e;return H(this,r),e=t.apply(this,arguments),e.code="ERR_JWKS_INVALID",e}return R(r)}(B);Q.code="ERR_JWKS_INVALID";var Z=function(e){C(r,e);var t=K(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"no applicable key found in the JSON Web Key Set",a=arguments.length>1?arguments[1]:void 0;return H(this,r),e=t.call(this,n,a),e.code="ERR_JWKS_NO_MATCHING_KEY",e}return R(r)}(B);Z.code="ERR_JWKS_NO_MATCHING_KEY";var ee=function(e){C(r,e);var t=K(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"multiple matching keys found in the JSON Web Key Set",a=arguments.length>1?arguments[1]:void 0;return H(this,r),e=t.call(this,n,a),e.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",e}return R(r)}(B);Symbol.asyncIterator,ee.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";var te=function(e){C(r,e);var t=K(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"request timed out",a=arguments.length>1?arguments[1]:void 0;return H(this,r),e=t.call(this,n,a),e.code="ERR_JWKS_TIMEOUT",e}return R(r)}(B);te.code="ERR_JWKS_TIMEOUT";var re=function(e){C(r,e);var t=K(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"signature verification failed",a=arguments.length>1?arguments[1]:void 0;return H(this,r),e=t.call(this,n,a),e.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",e}return R(r)}(B);re.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";var ne=o.getRandomValues.bind(o);function ae(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new V("Unsupported JWE Algorithm: ".concat(e))}}var oe=function(e){return ne(new Uint8Array(ae(e)>>3))},ie=function(e,t){if(t.length<<3!==ae(e))throw new X("Invalid Initialization Vector length")},ce=ie,ue=function(e,t){var r=e.byteLength<<3;if(r!==t)throw new X("Invalid Content Encryption Key length. Expected ".concat(t," bits, got ").concat(r," bits"))},se=ue,pe=function(e,t){if(!(e instanceof Uint8Array))throw new TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw new TypeError("Second argument must be a buffer");if(e.length!==t.length)throw new TypeError("Input buffers must have the same length");var r=e.length,n=0,a=-1;while(++a<r)n|=e[a]^t[a];return 0===n},fe=pe;function le(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"algorithm.name";return new TypeError("CryptoKey does not support this operation, its ".concat(t," must be ").concat(e))}function de(e,t){return e.name===t}function ye(e){return parseInt(e.name.slice(4),10)}function he(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function ve(e,t){if(t.length&&!t.some((function(t){return e.usages.includes(t)}))){var r="CryptoKey does not support this operation, its usages must include ";if(t.length>2){var n=t.pop();r+="one of ".concat(t.join(", "),", or ").concat(n,".")}else 2===t.length?r+="one of ".concat(t[0]," or ").concat(t[1],"."):r+="".concat(t[0],".");throw new TypeError(r)}}function be(e,t){switch(t){case"HS256":case"HS384":case"HS512":if(!de(e.algorithm,"HMAC"))throw le("HMAC");var r=parseInt(t.slice(2),10),n=ye(e.algorithm.hash);if(n!==r)throw le("SHA-".concat(r),"algorithm.hash");break;case"RS256":case"RS384":case"RS512":if(!de(e.algorithm,"RSASSA-PKCS1-v1_5"))throw le("RSASSA-PKCS1-v1_5");var a=parseInt(t.slice(2),10),o=ye(e.algorithm.hash);if(o!==a)throw le("SHA-".concat(a),"algorithm.hash");break;case"PS256":case"PS384":case"PS512":if(!de(e.algorithm,"RSA-PSS"))throw le("RSA-PSS");var i=parseInt(t.slice(2),10),c=ye(e.algorithm.hash);if(c!==i)throw le("SHA-".concat(i),"algorithm.hash");break;case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw le("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":if(!de(e.algorithm,"ECDSA"))throw le("ECDSA");var u=he(t),s=e.algorithm.namedCurve;if(s!==u)throw le(u,"algorithm.namedCurve");break;default:throw new TypeError("CryptoKey does not support this operation")}for(var p=arguments.length,f=new Array(p>2?p-2:0),l=2;l<p;l++)f[l-2]=arguments[l];ve(e,f)}function we(e,t){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":if(!de(e.algorithm,"AES-GCM"))throw le("AES-GCM");var r=parseInt(t.slice(1,4),10),n=e.algorithm.length;if(n!==r)throw le(r,"algorithm.length");break;case"A128KW":case"A192KW":case"A256KW":if(!de(e.algorithm,"AES-KW"))throw le("AES-KW");var a=parseInt(t.slice(1,4),10),o=e.algorithm.length;if(o!==a)throw le(a,"algorithm.length");break;case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw le("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!de(e.algorithm,"PBKDF2"))throw le("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(!de(e.algorithm,"RSA-OAEP"))throw le("RSA-OAEP");var i=parseInt(t.slice(9),10)||1,c=ye(e.algorithm.hash);if(c!==i)throw le("SHA-".concat(i),"algorithm.hash");break;default:throw new TypeError("CryptoKey does not support this operation")}for(var u=arguments.length,s=new Array(u>2?u-2:0),p=2;p<u;p++)s[p-2]=arguments[p];ve(e,s)}function me(e){return me="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function ge(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];if(n=n.filter(Boolean),n.length>2){var o=n.pop();e+="one of type ".concat(n.join(", "),", or ").concat(o,".")}else 2===n.length?e+="one of type ".concat(n[0]," or ").concat(n[1],"."):e+="of type ".concat(n[0],".");if(null==t)e+=" Received ".concat(t);else if("function"===typeof t&&t.name)e+=" Received function ".concat(t.name);else if("object"===me(t)&&null!=t){var i;null!==(i=t.constructor)&&void 0!==i&&i.name&&(e+=" Received an instance of ".concat(t.constructor.name))}return e}var ke=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return ge.apply(void 0,["Key must be ",e].concat(r))};function Se(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];return ge.apply(void 0,["Key for the ".concat(e," algorithm must be "),t].concat(n))}var Ae=function(e){return!!i(e)||"KeyObject"===(null===e||void 0===e?void 0:e[Symbol.toStringTag])},Ee=["CryptoKey"];function xe(e){return _e(e)||je(e)||Pe(e)||Oe()}function Oe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Pe(e,t){if(e){if("string"===typeof e)return Re(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Re(e,t):void 0}}function je(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _e(e){if(Array.isArray(e))return Re(e)}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function He(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Ce(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){He(o,n,a,i,c,"next",e)}function c(e){He(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Ke(e,t,r,n,a,o){return We.apply(this,arguments)}function We(){return We=Ce(regeneratorRuntime.mark((function e(t,r,n,a,i,c){var u,s,p,f,l,d,y;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r instanceof Uint8Array){e.next=2;break}throw new TypeError(ke(r,"Uint8Array"));case 2:return u=parseInt(t.slice(1,4),10),e.next=5,o.subtle.importKey("raw",r.subarray(u>>3),"AES-CBC",!1,["decrypt"]);case 5:return s=e.sent,e.next=8,o.subtle.importKey("raw",r.subarray(0,u>>3),{hash:"SHA-".concat(u<<1),name:"HMAC"},!1,["sign"]);case 8:return p=e.sent,f=v(c,a,n,m(c.length<<3)),e.t0=Uint8Array,e.next=13,o.subtle.sign("HMAC",p,f);case 13:e.t1=e.sent.slice(0,u>>3),l=new e.t0(e.t1);try{d=fe(i,l)}catch(h){}if(d){e.next=18;break}throw new z;case 18:return e.prev=18,e.t2=Uint8Array,e.next=22,o.subtle.decrypt({iv:a,name:"AES-CBC"},s,n);case 22:e.t3=e.sent,y=new e.t2(e.t3),e.next=28;break;case 26:e.prev=26,e.t4=e["catch"](18);case 28:if(y){e.next=30;break}throw new z;case 30:return e.abrupt("return",y);case 31:case"end":return e.stop()}}),e,null,[[18,26]])}))),We.apply(this,arguments)}function Te(e,t,r,n,a,o){return Ie.apply(this,arguments)}function Ie(){return Ie=Ce(regeneratorRuntime.mark((function e(t,r,n,a,i,c){var u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(r instanceof Uint8Array)){e.next=6;break}return e.next=3,o.subtle.importKey("raw",r,"AES-GCM",!1,["decrypt"]);case 3:u=e.sent,e.next=8;break;case 6:we(r,t,"decrypt"),u=r;case 8:return e.prev=8,e.t0=Uint8Array,e.next=12,o.subtle.decrypt({additionalData:c,iv:a,name:"AES-GCM",tagLength:128},u,v(n,i));case 12:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 16:throw e.prev=16,e.t2=e["catch"](8),new z;case 19:case"end":return e.stop()}}),e,null,[[8,16]])}))),Ie.apply(this,arguments)}var Je=function(){var e=Ce(regeneratorRuntime.mark((function e(t,r,n,a,o,c){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i(r)||r instanceof Uint8Array){e.next=2;break}throw new TypeError(ke.apply(void 0,[r].concat(xe(Ee),["Uint8Array"])));case 2:if(a){e.next=4;break}throw new X("JWE Initialization Vector missing");case 4:if(o){e.next=6;break}throw new X("JWE Authentication Tag missing");case 6:ce(t,a),e.t0=t,e.next="A128CBC-HS256"===e.t0||"A192CBC-HS384"===e.t0||"A256CBC-HS512"===e.t0?10:"A128GCM"===e.t0||"A192GCM"===e.t0||"A256GCM"===e.t0?12:14;break;case 10:return r instanceof Uint8Array&&se(r,parseInt(t.slice(-3),10)),e.abrupt("return",Ke(t,r,n,a,o,c));case 12:return r instanceof Uint8Array&&se(r,parseInt(t.slice(1,4),10)),e.abrupt("return",Te(t,r,n,a,o,c));case 14:throw new V("Unsupported JWE Content Encryption Algorithm");case 15:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o,i){return e.apply(this,arguments)}}(),De=Je;function Ue(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Me(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function Me(e,t){if(e){if("string"===typeof e)return Ne(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ne(e,t):void 0}}function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Be=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,a=t.filter(Boolean);if(0===a.length||1===a.length)return!0;var o,i=Ue(a);try{for(i.s();!(o=i.n()).done;){var c=o.value,u=Object.keys(c);if(n&&0!==n.size)for(var s=0,p=u;s<p.length;s++){var f=p[s];if(n.has(f))return!1;n.add(f)}else n=new Set(u)}}catch(l){i.e(l)}finally{i.f()}return!0},Ge=Be;function Le(e){return Le="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function Fe(e){return"object"===Le(e)&&null!==e}function Ve(e){if(!Fe(e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;var t=e;while(null!==Object.getPrototypeOf(t))t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var ze=[{hash:"SHA-256",name:"HMAC"},!0,["sign"]],Xe=ze;function $e(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Ye(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){$e(o,n,a,i,c,"next",e)}function c(e){$e(o,n,a,i,c,"throw",e)}i(void 0)}))}}function qe(e){return tt(e)||et(e)||Ze(e)||Qe()}function Qe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ze(e,t){if(e){if("string"===typeof e)return rt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rt(e,t):void 0}}function et(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function tt(e){if(Array.isArray(e))return rt(e)}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nt(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw new TypeError("Invalid key size for alg: ".concat(t))}function at(e,t,r){if(i(e))return we(e,t,r),e;if(e instanceof Uint8Array)return o.subtle.importKey("raw",e,"AES-KW",!0,[r]);throw new TypeError(ke.apply(void 0,[e].concat(qe(Ee),["Uint8Array"])))}var ot=function(){var e=Ye(regeneratorRuntime.mark((function e(t,r,n){var a,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,at(r,t,"wrapKey");case 2:return i=e.sent,nt(i,t),e.next=6,(a=o.subtle).importKey.apply(a,["raw",n].concat(qe(Xe)));case 6:return c=e.sent,e.t0=Uint8Array,e.next=10,o.subtle.wrapKey("raw",c,i,"AES-KW");case 10:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 12:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),it=function(){var e=Ye(regeneratorRuntime.mark((function e(t,r,n){var a,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,at(r,t,"unwrapKey");case 2:return i=e.sent,nt(i,t),e.next=6,(a=o.subtle).unwrapKey.apply(a,["raw",n,i,"AES-KW"].concat(qe(Xe)));case 6:return c=e.sent,e.t0=Uint8Array,e.next=10,o.subtle.exportKey("raw",c);case 10:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 12:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();function ct(e){return ft(e)||pt(e)||st(e)||ut()}function ut(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function st(e,t){if(e){if("string"===typeof e)return lt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lt(e,t):void 0}}function pt(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ft(e){if(Array.isArray(e))return lt(e)}function lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dt(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function yt(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){dt(o,n,a,i,c,"next",e)}function c(e){dt(o,n,a,i,c,"throw",e)}i(void 0)}))}}function ht(e,t,r,n){return vt.apply(this,arguments)}function vt(){return vt=yt(regeneratorRuntime.mark((function e(t,r,n,a){var c,u,s,p,f,l=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(c=l.length>4&&void 0!==l[4]?l[4]:new Uint8Array(0),u=l.length>5&&void 0!==l[5]?l[5]:new Uint8Array(0),i(t)){e.next=4;break}throw new TypeError(ke.apply(void 0,[t].concat(ct(Ee))));case 4:if(we(t,"ECDH"),i(r)){e.next=7;break}throw new TypeError(ke.apply(void 0,[r].concat(ct(Ee))));case 7:return we(r,"ECDH","deriveBits"),s=v(k(d.encode(n)),k(c),k(u),g(a)),p="X25519"===t.algorithm.name?256:"X448"===t.algorithm.name?448:Math.ceil(parseInt(t.algorithm.namedCurve.substr(-3),10)/8)<<3,e.t0=Uint8Array,e.next=13,o.subtle.deriveBits({name:t.algorithm.name,public:t},r,p);case 13:return e.t1=e.sent,f=new e.t0(e.t1),e.abrupt("return",S(f,a,s));case 16:case"end":return e.stop()}}),e)}))),vt.apply(this,arguments)}function bt(e){return wt.apply(this,arguments)}function wt(){return wt=yt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i(t)){e.next=2;break}throw new TypeError(ke.apply(void 0,[t].concat(ct(Ee))));case 2:return e.abrupt("return",o.subtle.generateKey(t.algorithm,!0,["deriveBits"]));case 3:case"end":return e.stop()}}),e)}))),wt.apply(this,arguments)}function mt(e){if(!i(e))throw new TypeError(ke.apply(void 0,[e].concat(ct(Ee))));return["P-256","P-384","P-521"].includes(e.algorithm.namedCurve)||"X25519"===e.algorithm.name||"X448"===e.algorithm.name}function gt(e){if(!(e instanceof Uint8Array)||e.length<8)throw new X("PBES2 Salt Input must be 8 or more octets")}function kt(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function St(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){kt(o,n,a,i,c,"next",e)}function c(e){kt(o,n,a,i,c,"throw",e)}i(void 0)}))}}function At(e){return Pt(e)||Ot(e)||xt(e)||Et()}function Et(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xt(e,t){if(e){if("string"===typeof e)return jt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?jt(e,t):void 0}}function Ot(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Pt(e){if(Array.isArray(e))return jt(e)}function jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _t(e,t){if(e instanceof Uint8Array)return o.subtle.importKey("raw",e,"PBKDF2",!1,["deriveBits"]);if(i(e))return we(e,t,"deriveBits","deriveKey"),e;throw new TypeError(ke.apply(void 0,[e].concat(At(Ee),["Uint8Array"])))}function Rt(e,t,r,n){return Ht.apply(this,arguments)}function Ht(){return Ht=St(regeneratorRuntime.mark((function e(t,r,n,a){var i,c,u,s,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return gt(t),i=b(r,t),c=parseInt(r.slice(13,16),10),u={hash:"SHA-".concat(r.slice(8,11)),iterations:n,name:"PBKDF2",salt:i},s={length:c,name:"AES-KW"},e.next=7,_t(a,r);case 7:if(p=e.sent,!p.usages.includes("deriveBits")){e.next=14;break}return e.t0=Uint8Array,e.next=12,o.subtle.deriveBits(u,p,c);case 12:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 14:if(!p.usages.includes("deriveKey")){e.next=16;break}return e.abrupt("return",o.subtle.deriveKey(u,p,s,!1,["wrapKey","unwrapKey"]));case 16:throw new TypeError('PBKDF2 key "usages" must include "deriveBits" or "deriveKey"');case 17:case"end":return e.stop()}}),e)}))),Ht.apply(this,arguments)}var Ct=function(){var e=St(regeneratorRuntime.mark((function e(t,r,n){var a,o,i,c,u=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=u.length>3&&void 0!==u[3]?u[3]:2048,o=u.length>4&&void 0!==u[4]?u[4]:ne(new Uint8Array(16)),e.next=4,Rt(o,t,a,r);case 4:return i=e.sent,e.next=7,ot(t.slice(-6),i,n);case 7:return c=e.sent,e.abrupt("return",{encryptedKey:c,p2c:a,p2s:x(o)});case 9:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),Kt=function(){var e=St(regeneratorRuntime.mark((function e(t,r,n,a,o){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Rt(o,t,a,r);case 2:return i=e.sent,e.abrupt("return",it(t.slice(-6),i,n));case 4:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o){return e.apply(this,arguments)}}();function Wt(e){switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new V("alg ".concat(e," is not supported either by JOSE or your javascript runtime"))}}var Tt=function(e,t){if(e.startsWith("RS")||e.startsWith("PS")){var r=t.algorithm.modulusLength;if("number"!==typeof r||r<2048)throw new TypeError("".concat(e," requires key modulusLength to be 2048 bits or larger"))}};function It(e){return Mt(e)||Ut(e)||Dt(e)||Jt()}function Jt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Dt(e,t){if(e){if("string"===typeof e)return Nt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Nt(e,t):void 0}}function Ut(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Mt(e){if(Array.isArray(e))return Nt(e)}function Nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bt(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Gt(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Bt(o,n,a,i,c,"next",e)}function c(e){Bt(o,n,a,i,c,"throw",e)}i(void 0)}))}}var Lt=function(){var e=Gt(regeneratorRuntime.mark((function e(t,r,n){var a,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i(r)){e.next=2;break}throw new TypeError(ke.apply(void 0,[r].concat(It(Ee))));case 2:if(we(r,t,"encrypt","wrapKey"),Tt(t,r),!r.usages.includes("encrypt")){e.next=10;break}return e.t0=Uint8Array,e.next=8,o.subtle.encrypt(Wt(t),r,n);case 8:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 10:if(!r.usages.includes("wrapKey")){e.next=19;break}return e.next=13,(a=o.subtle).importKey.apply(a,["raw",n].concat(It(Xe)));case 13:return c=e.sent,e.t2=Uint8Array,e.next=17,o.subtle.wrapKey("raw",c,r,Wt(t));case 17:return e.t3=e.sent,e.abrupt("return",new e.t2(e.t3));case 19:throw new TypeError('RSA-OAEP key "usages" must include "encrypt" or "wrapKey" for this operation');case 20:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),Ft=function(){var e=Gt(regeneratorRuntime.mark((function e(t,r,n){var a,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i(r)){e.next=2;break}throw new TypeError(ke.apply(void 0,[r].concat(It(Ee))));case 2:if(we(r,t,"decrypt","unwrapKey"),Tt(t,r),!r.usages.includes("decrypt")){e.next=10;break}return e.t0=Uint8Array,e.next=8,o.subtle.decrypt(Wt(t),r,n);case 8:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 10:if(!r.usages.includes("unwrapKey")){e.next=19;break}return e.next=13,(a=o.subtle).unwrapKey.apply(a,["raw",n,r,Wt(t)].concat(It(Xe)));case 13:return c=e.sent,e.t2=Uint8Array,e.next=17,o.subtle.exportKey("raw",c);case 17:return e.t3=e.sent,e.abrupt("return",new e.t2(e.t3));case 19:throw new TypeError('RSA-OAEP key "usages" must include "decrypt" or "unwrapKey" for this operation');case 20:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();function Vt(e){return Ve(e)&&"string"===typeof e.kty}function zt(e){return"oct"!==e.kty&&"string"===typeof e.d}function Xt(e){return"oct"!==e.kty&&"undefined"===typeof e.d}function $t(e){return Vt(e)&&"oct"===e.kty&&"string"===typeof e.k}function Yt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(r),!0).forEach((function(t){Qt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Qt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zt(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function er(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Zt(o,n,a,i,c,"next",e)}function c(e){Zt(o,n,a,i,c,"throw",e)}i(void 0)}))}}function tr(e){var t,r;switch(e.kty){case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:"SHA-".concat(e.alg.slice(-3))},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:"SHA-".concat(e.alg.slice(-3))},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:"SHA-".concat(parseInt(e.alg.slice(-3),10)||1)},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new V('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new V('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(e.alg){case"EdDSA":t={name:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new V('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new V('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}var rr=function(){var e=er(regeneratorRuntime.mark((function e(t){var r,n,a,i,c,u,s,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.alg){e.next=2;break}throw new TypeError('"alg" argument is required when "jwk.alg" is not present');case 2:return i=tr(t),c=i.algorithm,u=i.keyUsages,s=[c,null!==(r=t.ext)&&void 0!==r&&r,null!==(n=t.key_ops)&&void 0!==n?n:u],p=qt({},t),delete p.alg,delete p.use,e.abrupt("return",(a=o.subtle).importKey.apply(a,["jwk",p].concat(s)));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),nr=rr;function ar(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function or(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(r),!0).forEach((function(t){ir(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ar(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ir(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cr(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function ur(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){cr(o,n,a,i,c,"next",e)}function c(e){cr(o,n,a,i,c,"throw",e)}i(void 0)}))}}var sr,pr,fr=function(e){return P(e)},lr=function(e){return"KeyObject"===(null===e||void 0===e?void 0:e[Symbol.toStringTag])},dr=function(){var e=ur(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c,u=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=u.length>4&&void 0!==u[4]&&u[4],i=t.get(r),null===i||void 0===i||!i[a]){e.next=4;break}return e.abrupt("return",i[a]);case 4:return e.next=6,nr(or(or({},n),{},{alg:a}));case 6:return c=e.sent,o&&Object.freeze(r),i?i[a]=c:t.set(r,ir({},a,c)),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),yr=function(e,t){if(lr(e)){var r=e.export({format:"jwk"});return delete r.d,delete r.dp,delete r.dq,delete r.p,delete r.q,delete r.qi,r.k?fr(r.k):(pr||(pr=new WeakMap),dr(pr,e,r,t))}if(Vt(e)){if(e.k)return P(e.k);pr||(pr=new WeakMap);var n=dr(pr,e,e,t,!0);return n}return e},hr=function(e,t){if(lr(e)){var r=e.export({format:"jwk"});return r.k?fr(r.k):(sr||(sr=new WeakMap),dr(sr,e,r,t))}if(Vt(e)){if(e.k)return P(e.k);sr||(sr=new WeakMap);var n=dr(sr,e,e,t,!0);return n}return e},vr={normalizePublicKey:yr,normalizePrivateKey:hr};function br(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new V("Unsupported JWE Algorithm: ".concat(e))}}var wr=function(e){return ne(new Uint8Array(br(e)>>3))},mr=function(e,t){var r=(e.match(/.{1,64}/g)||[]).join("\n");return"-----BEGIN ".concat(t,"-----\n").concat(r,"\n-----END ").concat(t,"-----")};function gr(e){return Er(e)||Ar(e)||Sr(e)||kr()}function kr(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Sr(e,t){if(e){if("string"===typeof e)return xr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xr(e,t):void 0}}function Ar(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Er(e){if(Array.isArray(e))return xr(e)}function xr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Or(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Pr(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Or(o,n,a,i,c,"next",e)}function c(e){Or(o,n,a,i,c,"throw",e)}i(void 0)}))}}var jr=function(){var e=Pr(regeneratorRuntime.mark((function e(t,r,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i(n)){e.next=2;break}throw new TypeError(ke.apply(void 0,[n].concat(gr(Ee))));case 2:if(n.extractable){e.next=4;break}throw new TypeError("CryptoKey is not extractable");case 4:if(n.type===t){e.next=6;break}throw new TypeError("key is not a ".concat(t," key"));case 6:return e.t0=mr,e.t1=E,e.t2=Uint8Array,e.next=11,o.subtle.exportKey(r,n);case 11:return e.t3=e.sent,e.t4=new e.t2(e.t3),e.t5=(0,e.t1)(e.t4),e.t6="".concat(t.toUpperCase()," KEY"),e.abrupt("return",(0,e.t0)(e.t5,e.t6));case 16:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),_r=function(e){return jr("public","spki",e)},Rr=function(e){return jr("private","pkcs8",e)},Hr=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;0===n&&(r.unshift(r.length),r.unshift(6));var a=t.indexOf(r[0],n);if(-1===a)return!1;var o=t.subarray(a,a+r.length);return o.length===r.length&&(o.every((function(e,t){return e===r[t]}))||e(t,r,a+1))},Cr=function(e){switch(!0){case Hr(e,[42,134,72,206,61,3,1,7]):return"P-256";case Hr(e,[43,129,4,0,34]):return"P-384";case Hr(e,[43,129,4,0,35]):return"P-521";case Hr(e,[43,101,110]):return"X25519";case Hr(e,[43,101,111]):return"X448";case Hr(e,[43,101,112]):return"Ed25519";case Hr(e,[43,101,113]):return"Ed448";default:throw new V("Invalid or unsupported EC Key Curve or OKP Key Sub Type")}},Kr=function(){var e=Pr(regeneratorRuntime.mark((function e(t,r,n,a,i){var c,u,s,p,f,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:p=new Uint8Array(atob(n.replace(t,"")).split("").map((function(e){return e.charCodeAt(0)}))),f="spki"===r,e.t0=a,e.next="PS256"===e.t0||"PS384"===e.t0||"PS512"===e.t0?5:"RS256"===e.t0||"RS384"===e.t0||"RS512"===e.t0?8:"RSA-OAEP"===e.t0||"RSA-OAEP-256"===e.t0||"RSA-OAEP-384"===e.t0||"RSA-OAEP-512"===e.t0?11:"ES256"===e.t0?14:"ES384"===e.t0?17:"ES512"===e.t0?20:"ECDH-ES"===e.t0||"ECDH-ES+A128KW"===e.t0||"ECDH-ES+A192KW"===e.t0||"ECDH-ES+A256KW"===e.t0?23:"EdDSA"===e.t0?27:30;break;case 5:return u={name:"RSA-PSS",hash:"SHA-".concat(a.slice(-3))},s=f?["verify"]:["sign"],e.abrupt("break",31);case 8:return u={name:"RSASSA-PKCS1-v1_5",hash:"SHA-".concat(a.slice(-3))},s=f?["verify"]:["sign"],e.abrupt("break",31);case 11:return u={name:"RSA-OAEP",hash:"SHA-".concat(parseInt(a.slice(-3),10)||1)},s=f?["encrypt","wrapKey"]:["decrypt","unwrapKey"],e.abrupt("break",31);case 14:return u={name:"ECDSA",namedCurve:"P-256"},s=f?["verify"]:["sign"],e.abrupt("break",31);case 17:return u={name:"ECDSA",namedCurve:"P-384"},s=f?["verify"]:["sign"],e.abrupt("break",31);case 20:return u={name:"ECDSA",namedCurve:"P-521"},s=f?["verify"]:["sign"],e.abrupt("break",31);case 23:return l=Cr(p),u=l.startsWith("P-")?{name:"ECDH",namedCurve:l}:{name:l},s=f?[]:["deriveBits"],e.abrupt("break",31);case 27:return u={name:Cr(p)},s=f?["verify"]:["sign"],e.abrupt("break",31);case 30:throw new V('Invalid or unsupported "alg" (Algorithm) value');case 31:return e.abrupt("return",o.subtle.importKey(r,p,u,null!==(c=null===i||void 0===i?void 0:i.extractable)&&void 0!==c&&c,s));case 32:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o){return e.apply(this,arguments)}}(),Wr=function(e,t,r){return Kr(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,"pkcs8",e,t,r)},Tr=function(e,t,r){return Kr(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,"spki",e,t,r)};function Ir(e){var t=[],r=0;while(r<e.length){var n=Jr(e.subarray(r));t.push(n),r+=n.byteLength}return t}function Jr(e){var t=0,r=31&e[0];if(t++,31===r){r=0;while(e[t]>=128)r=128*r+e[t]-128,t++;r=128*r+e[t]-128,t++}var n=0;if(e[t]<128)n=e[t],t++;else{if(128===n){n=0;while(0!==e[t+n]||0!==e[t+n+1]){if(n>e.byteLength)throw new TypeError("invalid indefinite form length");n++}var a=t+n+2;return{byteLength:a,contents:e.subarray(t,t+n),raw:e.subarray(0,a)}}var o=127&e[t];t++,n=0;for(var i=0;i<o;i++)n=256*n+e[t],t++}var c=t+n;return{byteLength:c,contents:e.subarray(t,c),raw:e.subarray(0,c)}}function Dr(e){var t=Ir(Ir(Jr(e).contents)[0].contents);return E(t[160===t[0].raw[0]?6:5].raw)}function Ur(e){var t=e.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,""),r=O(t);return mr(Dr(r),"PUBLIC KEY")}var Mr=function(e,t,r){var n;try{n=Ur(e)}catch(a){throw new TypeError("Failed to parse the X.509 certificate",{cause:a})}return Tr(n,t,r)};function Nr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nr(Object(r),!0).forEach((function(t){Gr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Gr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lr(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Fr(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Lr(o,n,a,i,c,"next",e)}function c(e){Lr(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Vr(e,t,r){return zr.apply(this,arguments)}function zr(){return zr=Fr(regeneratorRuntime.mark((function e(t,r,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("string"===typeof t&&0===t.indexOf("-----BEGIN PUBLIC KEY-----")){e.next=2;break}throw new TypeError('"spki" must be SPKI formatted string');case 2:return e.abrupt("return",Tr(t,r,n));case 3:case"end":return e.stop()}}),e)}))),zr.apply(this,arguments)}function Xr(e,t,r){return $r.apply(this,arguments)}function $r(){return $r=Fr(regeneratorRuntime.mark((function e(t,r,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("string"===typeof t&&0===t.indexOf("-----BEGIN CERTIFICATE-----")){e.next=2;break}throw new TypeError('"x509" must be X.509 formatted string');case 2:return e.abrupt("return",Mr(t,r,n));case 3:case"end":return e.stop()}}),e)}))),$r.apply(this,arguments)}function Yr(e,t,r){return qr.apply(this,arguments)}function qr(){return qr=Fr(regeneratorRuntime.mark((function e(t,r,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("string"===typeof t&&0===t.indexOf("-----BEGIN PRIVATE KEY-----")){e.next=2;break}throw new TypeError('"pkcs8" must be PKCS#8 formatted string');case 2:return e.abrupt("return",Wr(t,r,n));case 3:case"end":return e.stop()}}),e)}))),qr.apply(this,arguments)}function Qr(e,t){return Zr.apply(this,arguments)}function Zr(){return Zr=Fr(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Ve(t)){e.next=2;break}throw new TypeError("JWK must be an object");case 2:r||(r=t.alg),e.t0=t.kty,e.next="oct"===e.t0?6:"RSA"===e.t0?9:"EC"===e.t0||"OKP"===e.t0?11:12;break;case 6:if("string"===typeof t.k&&t.k){e.next=8;break}throw new TypeError('missing "k" (Key Value) Parameter value');case 8:return e.abrupt("return",P(t.k));case 9:if(void 0===t.oth){e.next=11;break}throw new V('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case 11:return e.abrupt("return",nr(Br(Br({},t),{},{alg:r})));case 12:throw new V('Unsupported "kty" (Key Type) Parameter value');case 13:case"end":return e.stop()}}),e)}))),Zr.apply(this,arguments)}function en(e){return an(e)||nn(e)||rn(e)||tn()}function tn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rn(e,t){if(e){if("string"===typeof e)return on(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?on(e,t):void 0}}function nn(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function an(e){if(Array.isArray(e))return on(e)}function on(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var cn=function(e){return null===e||void 0===e?void 0:e[Symbol.toStringTag]},un=function(e,t,r){var n,a;if(void 0!==t.use&&"sig"!==t.use)throw new TypeError("Invalid key for this operation, when present its use must be sig");if(void 0!==t.key_ops&&!0!==(null===(n=(a=t.key_ops).includes)||void 0===n?void 0:n.call(a,r)))throw new TypeError("Invalid key for this operation, when present its key_ops must include ".concat(r));if(void 0!==t.alg&&t.alg!==e)throw new TypeError("Invalid key for this operation, when present its alg must be ".concat(e));return!0},sn=function(e,t,r,n){if(!(t instanceof Uint8Array)){if(n&&Vt(t)){if($t(t)&&un(e,t,r))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!Ae(t))throw new TypeError(Se.apply(void 0,[e,t].concat(en(Ee),["Uint8Array",n?"JSON Web Key":null])));if("secret"!==t.type)throw new TypeError("".concat(cn(t),' instances for symmetric algorithms must be of type "secret"'))}},pn=function(e,t,r,n){if(n&&Vt(t))switch(r){case"sign":if(zt(t)&&un(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(Xt(t)&&un(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!Ae(t))throw new TypeError(Se.apply(void 0,[e,t].concat(en(Ee),[n?"JSON Web Key":null])));if("secret"===t.type)throw new TypeError("".concat(cn(t),' instances for asymmetric algorithms must not be of type "secret"'));if("sign"===r&&"public"===t.type)throw new TypeError("".concat(cn(t),' instances for asymmetric algorithm signing must be of type "private"'));if("decrypt"===r&&"public"===t.type)throw new TypeError("".concat(cn(t),' instances for asymmetric algorithm decryption must be of type "private"'));if(t.algorithm&&"verify"===r&&"private"===t.type)throw new TypeError("".concat(cn(t),' instances for asymmetric algorithm verifying must be of type "public"'));if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw new TypeError("".concat(cn(t),' instances for asymmetric algorithm encryption must be of type "public"'))};function fn(e,t,r,n){var a=t.startsWith("HS")||"dir"===t||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t);a?sn(t,r,n,e):pn(t,r,n,e)}var ln=fn.bind(void 0,!1),dn=fn.bind(void 0,!0);function yn(e){return wn(e)||bn(e)||vn(e)||hn()}function hn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function vn(e,t){if(e){if("string"===typeof e)return mn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mn(e,t):void 0}}function bn(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function wn(e){if(Array.isArray(e))return mn(e)}function mn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gn(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function kn(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){gn(o,n,a,i,c,"next",e)}function c(e){gn(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Sn(e,t,r,n,a){return An.apply(this,arguments)}function An(){return An=kn(regeneratorRuntime.mark((function e(t,r,n,a,i){var c,u,s,p,f,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n instanceof Uint8Array){e.next=2;break}throw new TypeError(ke(n,"Uint8Array"));case 2:return c=parseInt(t.slice(1,4),10),e.next=5,o.subtle.importKey("raw",n.subarray(c>>3),"AES-CBC",!1,["encrypt"]);case 5:return u=e.sent,e.next=8,o.subtle.importKey("raw",n.subarray(0,c>>3),{hash:"SHA-".concat(c<<1),name:"HMAC"},!1,["sign"]);case 8:return s=e.sent,e.t0=Uint8Array,e.next=12,o.subtle.encrypt({iv:a,name:"AES-CBC"},u,r);case 12:return e.t1=e.sent,p=new e.t0(e.t1),f=v(i,a,p,m(i.length<<3)),e.t2=Uint8Array,e.next=18,o.subtle.sign("HMAC",s,f);case 18:return e.t3=e.sent.slice(0,c>>3),l=new e.t2(e.t3),e.abrupt("return",{ciphertext:p,tag:l,iv:a});case 21:case"end":return e.stop()}}),e)}))),An.apply(this,arguments)}function En(e,t,r,n,a){return xn.apply(this,arguments)}function xn(){return xn=kn(regeneratorRuntime.mark((function e(t,r,n,a,i){var c,u,s,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(n instanceof Uint8Array)){e.next=6;break}return e.next=3,o.subtle.importKey("raw",n,"AES-GCM",!1,["encrypt"]);case 3:c=e.sent,e.next=8;break;case 6:we(n,t,"encrypt"),c=n;case 8:return e.t0=Uint8Array,e.next=11,o.subtle.encrypt({additionalData:i,iv:a,name:"AES-GCM",tagLength:128},c,r);case 11:return e.t1=e.sent,u=new e.t0(e.t1),s=u.slice(-16),p=u.slice(0,-16),e.abrupt("return",{ciphertext:p,tag:s,iv:a});case 16:case"end":return e.stop()}}),e)}))),xn.apply(this,arguments)}var On=function(){var e=kn(regeneratorRuntime.mark((function e(t,r,n,a,o){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i(n)||n instanceof Uint8Array){e.next=2;break}throw new TypeError(ke.apply(void 0,[n].concat(yn(Ee),["Uint8Array"])));case 2:a?ce(t,a):a=oe(t),e.t0=t,e.next="A128CBC-HS256"===e.t0||"A192CBC-HS384"===e.t0||"A256CBC-HS512"===e.t0?6:"A128GCM"===e.t0||"A192GCM"===e.t0||"A256GCM"===e.t0?8:10;break;case 6:return n instanceof Uint8Array&&se(n,parseInt(t.slice(-3),10)),e.abrupt("return",Sn(t,r,n,a,o));case 8:return n instanceof Uint8Array&&se(n,parseInt(t.slice(1,4),10)),e.abrupt("return",En(t,r,n,a,o));case 10:throw new V("Unsupported JWE Content Encryption Algorithm");case 11:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o){return e.apply(this,arguments)}}(),Pn=On;function jn(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function _n(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){jn(o,n,a,i,c,"next",e)}function c(e){jn(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Rn(e,t,r,n){return Hn.apply(this,arguments)}function Hn(){return Hn=_n(regeneratorRuntime.mark((function e(t,r,n,a){var o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=t.slice(0,7),e.next=3,Pn(o,n,r,a,new Uint8Array(0));case 3:return i=e.sent,e.abrupt("return",{encryptedKey:i.ciphertext,iv:x(i.iv),tag:x(i.tag)});case 5:case"end":return e.stop()}}),e)}))),Hn.apply(this,arguments)}function Cn(e,t,r,n,a){return Kn.apply(this,arguments)}function Kn(){return Kn=_n(regeneratorRuntime.mark((function e(t,r,n,a,o){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.slice(0,7),e.abrupt("return",De(i,r,n,a,o,new Uint8Array(0)));case 2:case"end":return e.stop()}}),e)}))),Kn.apply(this,arguments)}function Wn(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Tn(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Wn(o,n,a,i,c,"next",e)}function c(e){Wn(o,n,a,i,c,"throw",e)}i(void 0)}))}}function In(e,t,r,n,a){return Jn.apply(this,arguments)}function Jn(){return Jn=Tn(regeneratorRuntime.mark((function e(t,r,n,a,o){var i,c,u,s,p,f,l,d,y;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return ln(t,r,"decrypt"),e.next=3,null===(i=vr.normalizePrivateKey)||void 0===i?void 0:i.call(vr,r,t);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=r;case 6:r=e.t0,e.t1=t,e.next="dir"===e.t1?10:"ECDH-ES"===e.t1?13:"ECDH-ES+A128KW"===e.t1||"ECDH-ES+A192KW"===e.t1||"ECDH-ES+A256KW"===e.t1?15:"RSA1_5"===e.t1||"RSA-OAEP"===e.t1||"RSA-OAEP-256"===e.t1||"RSA-OAEP-384"===e.t1||"RSA-OAEP-512"===e.t1?50:"PBES2-HS256+A128KW"===e.t1||"PBES2-HS384+A192KW"===e.t1||"PBES2-HS512+A256KW"===e.t1?53:"A128KW"===e.t1||"A192KW"===e.t1||"A256KW"===e.t1?70:"A128GCMKW"===e.t1||"A192GCMKW"===e.t1||"A256GCMKW"===e.t1?73:94;break;case 10:if(void 0===n){e.next=12;break}throw new X("Encountered unexpected JWE Encrypted Key");case 12:return e.abrupt("return",r);case 13:if(void 0===n){e.next=15;break}throw new X("Encountered unexpected JWE Encrypted Key");case 15:if(Ve(a.epk)){e.next=17;break}throw new X('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');case 17:if(mt(r)){e.next=19;break}throw new V("ECDH with the provided key is not allowed or not supported by your javascript runtime");case 19:return e.next=21,Qr(a.epk,t);case 21:if(c=e.sent,void 0===a.apu){e.next=32;break}if("string"===typeof a.apu){e.next=25;break}throw new X('JOSE Header "apu" (Agreement PartyUInfo) invalid');case 25:e.prev=25,u=P(a.apu),e.next=32;break;case 29:throw e.prev=29,e.t2=e["catch"](25),new X("Failed to base64url decode the apu");case 32:if(void 0===a.apv){e.next=42;break}if("string"===typeof a.apv){e.next=35;break}throw new X('JOSE Header "apv" (Agreement PartyVInfo) invalid');case 35:e.prev=35,s=P(a.apv),e.next=42;break;case 39:throw e.prev=39,e.t3=e["catch"](35),new X("Failed to base64url decode the apv");case 42:return e.next=44,ht(c,r,"ECDH-ES"===t?a.enc:t,"ECDH-ES"===t?br(a.enc):parseInt(t.slice(-5,-2),10),u,s);case 44:if(p=e.sent,"ECDH-ES"!==t){e.next=47;break}return e.abrupt("return",p);case 47:if(void 0!==n){e.next=49;break}throw new X("JWE Encrypted Key missing");case 49:return e.abrupt("return",it(t.slice(-6),p,n));case 50:if(void 0!==n){e.next=52;break}throw new X("JWE Encrypted Key missing");case 52:return e.abrupt("return",Ft(t,r,n));case 53:if(void 0!==n){e.next=55;break}throw new X("JWE Encrypted Key missing");case 55:if("number"===typeof a.p2c){e.next=57;break}throw new X('JOSE Header "p2c" (PBES2 Count) missing or invalid');case 57:if(f=(null===o||void 0===o?void 0:o.maxPBES2Count)||1e4,!(a.p2c>f)){e.next=60;break}throw new X('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');case 60:if("string"===typeof a.p2s){e.next=62;break}throw new X('JOSE Header "p2s" (PBES2 Salt) missing or invalid');case 62:e.prev=62,l=P(a.p2s),e.next=69;break;case 66:throw e.prev=66,e.t4=e["catch"](62),new X("Failed to base64url decode the p2s");case 69:return e.abrupt("return",Kt(t,r,n,a.p2c,l));case 70:if(void 0!==n){e.next=72;break}throw new X("JWE Encrypted Key missing");case 72:return e.abrupt("return",it(t,r,n));case 73:if(void 0!==n){e.next=75;break}throw new X("JWE Encrypted Key missing");case 75:if("string"===typeof a.iv){e.next=77;break}throw new X('JOSE Header "iv" (Initialization Vector) missing or invalid');case 77:if("string"===typeof a.tag){e.next=79;break}throw new X('JOSE Header "tag" (Authentication Tag) missing or invalid');case 79:e.prev=79,d=P(a.iv),e.next=86;break;case 83:throw e.prev=83,e.t5=e["catch"](79),new X("Failed to base64url decode the iv");case 86:e.prev=86,y=P(a.tag),e.next=93;break;case 90:throw e.prev=90,e.t6=e["catch"](86),new X("Failed to base64url decode the tag");case 93:return e.abrupt("return",Cn(t,r,n,d,y));case 94:throw new V('Invalid or unsupported "alg" (JWE Algorithm) header value');case 95:case"end":return e.stop()}}),e,null,[[25,29],[35,39],[62,66],[79,83],[86,90]])}))),Jn.apply(this,arguments)}var Dn=In;function Un(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Bn(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function Mn(e){return Ln(e)||Gn(e)||Bn(e)||Nn()}function Nn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Bn(e,t){if(e){if("string"===typeof e)return Fn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fn(e,t):void 0}}function Gn(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ln(e){if(Array.isArray(e))return Fn(e)}function Fn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vn(e,t,r,n,a){if(void 0!==a.crit&&void 0===(null===n||void 0===n?void 0:n.crit))throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some((function(e){return"string"!==typeof e||0===e.length})))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');var o;o=void 0!==r?new Map([].concat(Mn(Object.entries(r)),Mn(t.entries()))):t;var i,c=Un(n.crit);try{for(c.s();!(i=c.n()).done;){var u=i.value;if(!o.has(u))throw new V('Extension Header Parameter "'.concat(u,'" is not recognized'));if(void 0===a[u])throw new e('Extension Header Parameter "'.concat(u,'" is missing'));if(o.get(u)&&void 0===n[u])throw new e('Extension Header Parameter "'.concat(u,'" MUST be integrity protected'))}}catch(s){c.e(s)}finally{c.f()}return new Set(n.crit)}var zn=Vn,Xn=function(e,t){if(void 0!==t&&(!Array.isArray(t)||t.some((function(e){return"string"!==typeof e}))))throw new TypeError('"'.concat(e,'" option must be an array of strings'));if(t)return new Set(t)},$n=Xn;function Yn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yn(Object(r),!0).forEach((function(t){Qn(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Qn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zn(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function ea(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Zn(o,n,a,i,c,"next",e)}function c(e){Zn(o,n,a,i,c,"throw",e)}i(void 0)}))}}function ta(e,t,r){return ra.apply(this,arguments)}function ra(){return ra=ea(regeneratorRuntime.mark((function e(t,r,n){var a,o,i,c,u,s,p,f,l,h,b,w,m,g,k,S,A,E;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Ve(t)){e.next=2;break}throw new X("Flattened JWE must be an object");case 2:if(void 0!==t.protected||void 0!==t.header||void 0!==t.unprotected){e.next=4;break}throw new X("JOSE Header missing");case 4:if(void 0===t.iv||"string"===typeof t.iv){e.next=6;break}throw new X("JWE Initialization Vector incorrect type");case 6:if("string"===typeof t.ciphertext){e.next=8;break}throw new X("JWE Ciphertext missing or incorrect type");case 8:if(void 0===t.tag||"string"===typeof t.tag){e.next=10;break}throw new X("JWE Authentication Tag incorrect type");case 10:if(void 0===t.protected||"string"===typeof t.protected){e.next=12;break}throw new X("JWE Protected Header incorrect type");case 12:if(void 0===t.encrypted_key||"string"===typeof t.encrypted_key){e.next=14;break}throw new X("JWE Encrypted Key incorrect type");case 14:if(void 0===t.aad||"string"===typeof t.aad){e.next=16;break}throw new X("JWE AAD incorrect type");case 16:if(void 0===t.header||Ve(t.header)){e.next=18;break}throw new X("JWE Shared Unprotected Header incorrect type");case 18:if(void 0===t.unprotected||Ve(t.unprotected)){e.next=20;break}throw new X("JWE Per-Recipient Unprotected Header incorrect type");case 20:if(!t.protected){e.next=29;break}e.prev=21,i=P(t.protected),o=JSON.parse(y.decode(i)),e.next=29;break;case 26:throw e.prev=26,e.t0=e["catch"](21),new X("JWE Protected Header is invalid");case 29:if(Ge(o,t.header,t.unprotected)){e.next=31;break}throw new X("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");case 31:if(c=qn(qn(qn({},o),t.header),t.unprotected),zn(X,new Map,null===n||void 0===n?void 0:n.crit,o,c),void 0===c.zip){e.next=35;break}throw new V('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');case 35:if(u=c.alg,s=c.enc,"string"===typeof u&&u){e.next=38;break}throw new X("missing JWE Algorithm (alg) in JWE Header");case 38:if("string"===typeof s&&s){e.next=40;break}throw new X("missing JWE Encryption Algorithm (enc) in JWE Header");case 40:if(p=n&&$n("keyManagementAlgorithms",n.keyManagementAlgorithms),f=n&&$n("contentEncryptionAlgorithms",n.contentEncryptionAlgorithms),!(p&&!p.has(u)||!p&&u.startsWith("PBES2"))){e.next=44;break}throw new F('"alg" (Algorithm) Header Parameter value not allowed');case 44:if(!f||f.has(s)){e.next=46;break}throw new F('"enc" (Encryption Algorithm) Header Parameter value not allowed');case 46:if(void 0===t.encrypted_key){e.next=54;break}e.prev=47,l=P(t.encrypted_key),e.next=54;break;case 51:throw e.prev=51,e.t1=e["catch"](47),new X("Failed to base64url decode the encrypted_key");case 54:if(h=!1,"function"!==typeof r){e.next=60;break}return e.next=58,r(o,t);case 58:r=e.sent,h=!0;case 60:return e.prev=60,e.next=63,Dn(u,r,l,c,n);case 63:b=e.sent,e.next=71;break;case 66:if(e.prev=66,e.t2=e["catch"](60),!(e.t2 instanceof TypeError||e.t2 instanceof X||e.t2 instanceof V)){e.next=70;break}throw e.t2;case 70:b=wr(s);case 71:if(void 0===t.iv){e.next=79;break}e.prev=72,w=P(t.iv),e.next=79;break;case 76:throw e.prev=76,e.t3=e["catch"](72),new X("Failed to base64url decode the iv");case 79:if(void 0===t.tag){e.next=87;break}e.prev=80,m=P(t.tag),e.next=87;break;case 84:throw e.prev=84,e.t4=e["catch"](80),new X("Failed to base64url decode the tag");case 87:g=d.encode(null!==(a=t.protected)&&void 0!==a?a:""),k=void 0!==t.aad?v(g,d.encode("."),d.encode(t.aad)):g,e.prev=89,S=P(t.ciphertext),e.next=96;break;case 93:throw e.prev=93,e.t5=e["catch"](89),new X("Failed to base64url decode the ciphertext");case 96:return e.next=98,De(s,b,S,w,m,k);case 98:if(A=e.sent,E={plaintext:A},void 0!==t.protected&&(E.protectedHeader=o),void 0===t.aad){e.next=109;break}e.prev=102,E.additionalAuthenticatedData=P(t.aad),e.next=109;break;case 106:throw e.prev=106,e.t6=e["catch"](102),new X("Failed to base64url decode the aad");case 109:if(void 0!==t.unprotected&&(E.sharedUnprotectedHeader=t.unprotected),void 0!==t.header&&(E.unprotectedHeader=t.header),!h){e.next=113;break}return e.abrupt("return",qn(qn({},E),{},{key:r}));case 113:return e.abrupt("return",E);case 114:case"end":return e.stop()}}),e,null,[[21,26],[47,51],[60,66],[72,76],[80,84],[89,93],[102,106]])}))),ra.apply(this,arguments)}function na(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function aa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?na(Object(r),!0).forEach((function(t){oa(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):na(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ia(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function ca(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){ia(o,n,a,i,c,"next",e)}function c(e){ia(o,n,a,i,c,"throw",e)}i(void 0)}))}}function ua(e,t,r){return sa.apply(this,arguments)}function sa(){return sa=ca(regeneratorRuntime.mark((function e(t,r,n){var a,o,i,c,u,s,p,f,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t instanceof Uint8Array&&(t=y.decode(t)),"string"===typeof t){e.next=3;break}throw new X("Compact JWE must be a string or Uint8Array");case 3:if(a=t.split("."),o=a[0],i=a[1],c=a[2],u=a[3],s=a[4],p=a.length,5===p){e.next=6;break}throw new X("Invalid Compact JWE");case 6:return e.next=8,ta({ciphertext:u,iv:c||void 0,protected:o,tag:s||void 0,encrypted_key:i||void 0},r,n);case 8:if(f=e.sent,l={plaintext:f.plaintext,protectedHeader:f.protectedHeader},"function"!==typeof r){e.next=12;break}return e.abrupt("return",aa(aa({},l),{},{key:f.key}));case 12:return e.abrupt("return",l);case 13:case"end":return e.stop()}}),e)}))),sa.apply(this,arguments)}function pa(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=fa(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function fa(e,t){if(e){if("string"===typeof e)return la(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?la(e,t):void 0}}function la(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function da(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function ya(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){da(o,n,a,i,c,"next",e)}function c(e){da(o,n,a,i,c,"throw",e)}i(void 0)}))}}function ha(e,t,r){return va.apply(this,arguments)}function va(){return va=ya(regeneratorRuntime.mark((function e(t,r,n){var a,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Ve(t)){e.next=2;break}throw new X("General JWE must be an object");case 2:if(Array.isArray(t.recipients)&&t.recipients.every(Ve)){e.next=4;break}throw new X("JWE Recipients missing or incorrect type");case 4:if(t.recipients.length){e.next=6;break}throw new X("JWE Recipients has no members");case 6:a=pa(t.recipients),e.prev=7,a.s();case 9:if((o=a.n()).done){e.next=21;break}return i=o.value,e.prev=11,e.next=14,ta({aad:t.aad,ciphertext:t.ciphertext,encrypted_key:i.encrypted_key,header:i.header,iv:t.iv,protected:t.protected,tag:t.tag,unprotected:t.unprotected},r,n);case 14:return e.abrupt("return",e.sent);case 17:e.prev=17,e.t0=e["catch"](11);case 19:e.next=9;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e["catch"](7),a.e(e.t1);case 26:return e.prev=26,a.f(),e.finish(26);case 29:throw new z;case 30:case"end":return e.stop()}}),e,null,[[7,23,26,29],[11,17]])}))),va.apply(this,arguments)}var ba=Symbol(),wa=["ext","key_ops","alg","use"];function ma(e,t){if(null==e)return{};var r,n,a=ga(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ga(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}function ka(e){return xa(e)||Ea(e)||Aa(e)||Sa()}function Sa(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Aa(e,t){if(e){if("string"===typeof e)return Oa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Oa(e,t):void 0}}function Ea(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function xa(e){if(Array.isArray(e))return Oa(e)}function Oa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pa(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function ja(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Pa(o,n,a,i,c,"next",e)}function c(e){Pa(o,n,a,i,c,"throw",e)}i(void 0)}))}}var _a=function(){var e=ja(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t instanceof Uint8Array)){e.next=2;break}return e.abrupt("return",{kty:"oct",k:x(t)});case 2:if(i(t)){e.next=4;break}throw new TypeError(ke.apply(void 0,[t].concat(ka(Ee),["Uint8Array"])));case 4:if(t.extractable){e.next=6;break}throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");case 6:return e.next=8,o.subtle.exportKey("jwk",t);case 8:return r=e.sent,r.ext,r.key_ops,r.alg,r.use,n=ma(r,wa),e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ra=_a;function Ha(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Ca(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ha(o,n,a,i,c,"next",e)}function c(e){Ha(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Ka(e){return Wa.apply(this,arguments)}function Wa(){return Wa=Ca(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",_r(t));case 1:case"end":return e.stop()}}),e)}))),Wa.apply(this,arguments)}function Ta(e){return Ia.apply(this,arguments)}function Ia(){return Ia=Ca(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Rr(t));case 1:case"end":return e.stop()}}),e)}))),Ia.apply(this,arguments)}function Ja(e){return Da.apply(this,arguments)}function Da(){return Da=Ca(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Ra(t));case 1:case"end":return e.stop()}}),e)}))),Da.apply(this,arguments)}var Ua=["encryptedKey"],Ma=["encryptedKey"];function Na(e,t){if(null==e)return{};var r,n,a=Ba(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ba(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}function Ga(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function La(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ga(o,n,a,i,c,"next",e)}function c(e){Ga(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Fa(e,t,r,n){return Va.apply(this,arguments)}function Va(){return Va=La(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c,u,s,p,f,l,d,y,h,v,b,w,m,g,k,S,A,E,O=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=O.length>4&&void 0!==O[4]?O[4]:{},ln(t,n,"encrypt"),e.next=4,null===(o=vr.normalizePublicKey)||void 0===o?void 0:o.call(vr,n,t);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=n;case 7:n=e.t0,e.t1=t,e.next="dir"===e.t1?11:"ECDH-ES"===e.t1||"ECDH-ES+A128KW"===e.t1||"ECDH-ES+A192KW"===e.t1||"ECDH-ES+A256KW"===e.t1?13:"RSA1_5"===e.t1||"RSA-OAEP"===e.t1||"RSA-OAEP-256"===e.t1||"RSA-OAEP-384"===e.t1||"RSA-OAEP-512"===e.t1?45:"PBES2-HS256+A128KW"===e.t1||"PBES2-HS384+A192KW"===e.t1||"PBES2-HS512+A256KW"===e.t1?50:"A128KW"===e.t1||"A192KW"===e.t1||"A256KW"===e.t1?59:"A128GCMKW"===e.t1||"A192GCMKW"===e.t1||"A256GCMKW"===e.t1?64:73;break;case 11:return s=n,e.abrupt("break",74);case 13:if(mt(n)){e.next=15;break}throw new V("ECDH with the provided key is not allowed or not supported by your javascript runtime");case 15:if(p=i.apu,f=i.apv,l=i.epk,e.t2=l,e.t2){e.next=22;break}return e.next=21,bt(n);case 21:l=e.sent.privateKey;case 22:return e.next=24,Ja(l);case 24:return d=e.sent,y=d.x,h=d.y,v=d.crv,b=d.kty,e.next=31,ht(n,l,"ECDH-ES"===t?r:t,"ECDH-ES"===t?br(r):parseInt(t.slice(-5,-2),10),p,f);case 31:if(w=e.sent,u={epk:{x:y,crv:v,kty:b}},"EC"===b&&(u.epk.y=h),p&&(u.apu=x(p)),f&&(u.apv=x(f)),"ECDH-ES"!==t){e.next=39;break}return s=w,e.abrupt("break",74);case 39:return s=a||wr(r),m=t.slice(-6),e.next=43,ot(m,w,s);case 43:return c=e.sent,e.abrupt("break",74);case 45:return s=a||wr(r),e.next=48,Lt(t,n,s);case 48:return c=e.sent,e.abrupt("break",74);case 50:return s=a||wr(r),g=i.p2c,k=i.p2s,e.next=54,Ct(t,n,s,g,k);case 54:return S=e.sent,c=S.encryptedKey,u=Na(S,Ua),e.abrupt("break",74);case 59:return s=a||wr(r),e.next=62,ot(t,n,s);case 62:return c=e.sent,e.abrupt("break",74);case 64:return s=a||wr(r),A=i.iv,e.next=68,Rn(t,n,s,A);case 68:return E=e.sent,c=E.encryptedKey,u=Na(E,Ma),e.abrupt("break",74);case 73:throw new V('Invalid or unsupported "alg" (JWE Algorithm) header value');case 74:return e.abrupt("return",{cek:s,encryptedKey:c,parameters:u});case 75:case"end":return e.stop()}}),e)}))),Va.apply(this,arguments)}var za=Fa;function Xa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xa(Object(r),!0).forEach((function(t){Ya(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ya(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qa(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Qa(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){qa(o,n,a,i,c,"next",e)}function c(e){qa(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Za(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function to(e,t,r){return t&&eo(e.prototype,t),r&&eo(e,r),e}var ro=function(){function e(t){if(Za(this,e),!(t instanceof Uint8Array))throw new TypeError("plaintext must be an instance of Uint8Array");this._plaintext=t}return to(e,[{key:"setKeyManagementParameters",value:function(e){if(this._keyManagementParameters)throw new TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}},{key:"setProtectedHeader",value:function(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}},{key:"setSharedUnprotectedHeader",value:function(e){if(this._sharedUnprotectedHeader)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}},{key:"setUnprotectedHeader",value:function(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}},{key:"setAdditionalAuthenticatedData",value:function(e){return this._aad=e,this}},{key:"setContentEncryptionKey",value:function(e){if(this._cek)throw new TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}},{key:"setInitializationVector",value:function(e){if(this._iv)throw new TypeError("setInitializationVector can only be called once");return this._iv=e,this}},{key:"encrypt",value:function(){var e=Qa(regeneratorRuntime.mark((function e(t,r){var n,a,o,i,c,u,s,p,f,l,h,b,w,m,g;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this._protectedHeader||this._unprotectedHeader||this._sharedUnprotectedHeader){e.next=2;break}throw new X("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");case 2:if(Ge(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader)){e.next=4;break}throw new X("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");case 4:if(n=$a($a($a({},this._protectedHeader),this._unprotectedHeader),this._sharedUnprotectedHeader),zn(X,new Map,null===r||void 0===r?void 0:r.crit,this._protectedHeader,n),void 0===n.zip){e.next=8;break}throw new V('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');case 8:if(a=n.alg,o=n.enc,"string"===typeof a&&a){e.next=11;break}throw new X('JWE "alg" (Algorithm) Header Parameter missing or invalid');case 11:if("string"===typeof o&&o){e.next=13;break}throw new X('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');case 13:if(!this._cek||"dir"!==a&&"ECDH-ES"!==a){e.next=15;break}throw new TypeError('setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header '.concat(a));case 15:return e.next=17,za(a,o,t,this._cek,this._keyManagementParameters);case 17:return s=e.sent,c=s.cek,i=s.encryptedKey,u=s.parameters,u&&(r&&ba in r?this._unprotectedHeader?this._unprotectedHeader=$a($a({},this._unprotectedHeader),u):this.setUnprotectedHeader(u):this._protectedHeader?this._protectedHeader=$a($a({},this._protectedHeader),u):this.setProtectedHeader(u)),f=this._protectedHeader?d.encode(x(JSON.stringify(this._protectedHeader))):d.encode(""),this._aad?(l=x(this._aad),p=v(f,d.encode("."),d.encode(l))):p=f,e.next=26,Pn(o,this._plaintext,c,this._iv,p);case 26:return h=e.sent,b=h.ciphertext,w=h.tag,m=h.iv,g={ciphertext:x(b)},m&&(g.iv=x(m)),w&&(g.tag=x(w)),i&&(g.encrypted_key=x(i)),l&&(g.aad=l),this._protectedHeader&&(g.protected=y.decode(f)),this._sharedUnprotectedHeader&&(g.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(g.header=this._unprotectedHeader),e.abrupt("return",g);case 39:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}();function no(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ao(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?no(Object(r),!0).forEach((function(t){oo(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):no(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function io(e,t){return fo(e)||po(e,t)||uo(e,t)||co()}function co(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function uo(e,t){if(e){if("string"===typeof e)return so(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?so(e,t):void 0}}function so(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function po(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done);i=!0)if(o.push(n.value),t&&o.length===t)break}catch(u){c=!0,a=u}finally{try{i||null==r["return"]||r["return"]()}finally{if(c)throw a}}return o}}function fo(e){if(Array.isArray(e))return e}function lo(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function yo(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){lo(o,n,a,i,c,"next",e)}function c(e){lo(o,n,a,i,c,"throw",e)}i(void 0)}))}}function ho(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bo(e,t,r){return t&&vo(e.prototype,t),r&&vo(e,r),e}var wo=function(){function e(t,r,n){ho(this,e),this.parent=t,this.key=r,this.options=n}return bo(e,[{key:"setUnprotectedHeader",value:function(e){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}},{key:"addRecipient",value:function(){var e;return(e=this.parent).addRecipient.apply(e,arguments)}},{key:"encrypt",value:function(){var e;return(e=this.parent).encrypt.apply(e,arguments)}},{key:"done",value:function(){return this.parent}}]),e}(),mo=function(){function e(t){ho(this,e),this._recipients=[],this._plaintext=t}return bo(e,[{key:"addRecipient",value:function(e,t){var r=new wo(this,e,{crit:null===t||void 0===t?void 0:t.crit});return this._recipients.push(r),r}},{key:"setProtectedHeader",value:function(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}},{key:"setSharedUnprotectedHeader",value:function(e){if(this._unprotectedHeader)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}},{key:"setAdditionalAuthenticatedData",value:function(e){return this._aad=e,this}},{key:"encrypt",value:function(){var e=yo(regeneratorRuntime.mark((function e(){var t,r,n,a,o,i,c,u,s,p,f,l,d,y,h,v,b,w,m,g,k,S,A;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this._recipients.length){e.next=2;break}throw new X("at least one recipient must be added");case 2:if(1!==this._recipients.length){e.next=14;break}return t=io(this._recipients,1),r=t[0],e.next=6,new ro(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(r.unprotectedHeader).encrypt(r.key,ao({},r.options));case 6:return n=e.sent,a={ciphertext:n.ciphertext,iv:n.iv,recipients:[{}],tag:n.tag},n.aad&&(a.aad=n.aad),n.protected&&(a.protected=n.protected),n.unprotected&&(a.unprotected=n.unprotected),n.encrypted_key&&(a.recipients[0].encrypted_key=n.encrypted_key),n.header&&(a.recipients[0].header=n.header),e.abrupt("return",a);case 14:i=0;case 15:if(!(i<this._recipients.length)){e.next=39;break}if(c=this._recipients[i],Ge(this._protectedHeader,this._unprotectedHeader,c.unprotectedHeader)){e.next=19;break}throw new X("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");case 19:if(u=ao(ao(ao({},this._protectedHeader),this._unprotectedHeader),c.unprotectedHeader),s=u.alg,"string"===typeof s&&s){e.next=23;break}throw new X('JWE "alg" (Algorithm) Header Parameter missing or invalid');case 23:if("dir"!==s&&"ECDH-ES"!==s){e.next=25;break}throw new X('"dir" and "ECDH-ES" alg may only be used with a single recipient');case 25:if("string"===typeof u.enc&&u.enc){e.next=27;break}throw new X('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');case 27:if(o){e.next=31;break}o=u.enc,e.next=33;break;case 31:if(o===u.enc){e.next=33;break}throw new X('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients');case 33:if(zn(X,new Map,c.options.crit,this._protectedHeader,u),void 0===u.zip){e.next=36;break}throw new V('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');case 36:i++,e.next=15;break;case 39:p=wr(o),f={ciphertext:"",iv:"",recipients:[],tag:""},l=0;case 42:if(!(l<this._recipients.length)){e.next=71;break}if(v=this._recipients[l],b={},f.recipients.push(b),w=ao(ao(ao({},this._protectedHeader),this._unprotectedHeader),v.unprotectedHeader),m=w.alg.startsWith("PBES2")?2048+l:void 0,0!==l){e.next=61;break}return e.next=51,new ro(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(p).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(v.unprotectedHeader).setKeyManagementParameters({p2c:m}).encrypt(v.key,ao(ao({},v.options),{},oo({},ba,!0)));case 51:return g=e.sent,f.ciphertext=g.ciphertext,f.iv=g.iv,f.tag=g.tag,g.aad&&(f.aad=g.aad),g.protected&&(f.protected=g.protected),g.unprotected&&(f.unprotected=g.unprotected),b.encrypted_key=g.encrypted_key,g.header&&(b.header=g.header),e.abrupt("continue",68);case 61:return e.next=63,za((null===(d=v.unprotectedHeader)||void 0===d?void 0:d.alg)||(null===(y=this._protectedHeader)||void 0===y?void 0:y.alg)||(null===(h=this._unprotectedHeader)||void 0===h?void 0:h.alg),o,v.key,p,{p2c:m});case 63:k=e.sent,S=k.encryptedKey,A=k.parameters,b.encrypted_key=x(S),(v.unprotectedHeader||A)&&(b.header=ao(ao({},v.unprotectedHeader),A));case 68:l++,e.next=42;break;case 71:return e.abrupt("return",f);case 72:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}();function go(e,t){var r="SHA-".concat(e.slice(-3));switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"EdDSA":return{name:t.name};default:throw new V("alg ".concat(e," is not supported either by JOSE or your javascript runtime"))}}function ko(e){return xo(e)||Eo(e)||Ao(e)||So()}function So(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ao(e,t){if(e){if("string"===typeof e)return Oo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Oo(e,t):void 0}}function Eo(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function xo(e){if(Array.isArray(e))return Oo(e)}function Oo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Po(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function jo(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Po(o,n,a,i,c,"next",e)}function c(e){Po(o,n,a,i,c,"throw",e)}i(void 0)}))}}function _o(e,t,r){return Ro.apply(this,arguments)}function Ro(){return Ro=jo(regeneratorRuntime.mark((function e(t,r,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("sign"!==n){e.next=4;break}return e.next=3,vr.normalizePrivateKey(r,t);case 3:r=e.sent;case 4:if("verify"!==n){e.next=8;break}return e.next=7,vr.normalizePublicKey(r,t);case 7:r=e.sent;case 8:if(!i(r)){e.next=11;break}return be(r,t,n),e.abrupt("return",r);case 11:if(!(r instanceof Uint8Array)){e.next=15;break}if(t.startsWith("HS")){e.next=14;break}throw new TypeError(ke.apply(void 0,[r].concat(ko(Ee))));case 14:return e.abrupt("return",o.subtle.importKey("raw",r,{hash:"SHA-".concat(t.slice(-3)),name:"HMAC"},!1,[n]));case 15:throw new TypeError(ke.apply(void 0,[r].concat(ko(Ee),["Uint8Array","JSON Web Key"])));case 16:case"end":return e.stop()}}),e)}))),Ro.apply(this,arguments)}function Ho(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Co(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ho(o,n,a,i,c,"next",e)}function c(e){Ho(o,n,a,i,c,"throw",e)}i(void 0)}))}}var Ko=function(){var e=Co(regeneratorRuntime.mark((function e(t,r,n,a){var i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_o(t,r,"verify");case 2:return i=e.sent,Tt(t,i),c=go(t,i.algorithm),e.prev=5,e.next=8,o.subtle.verify(c,i,n,a);case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e["catch"](5),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t,r,n,a){return e.apply(this,arguments)}}(),Wo=Ko;function To(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Io(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?To(Object(r),!0).forEach((function(t){Jo(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):To(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Jo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Do(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Uo(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Do(o,n,a,i,c,"next",e)}function c(e){Do(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Mo(e,t,r){return No.apply(this,arguments)}function No(){return No=Uo(regeneratorRuntime.mark((function e(t,r,n){var a,o,i,c,u,s,p,f,l,h,b,w,m,g;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Ve(t)){e.next=2;break}throw new $("Flattened JWS must be an object");case 2:if(void 0!==t.protected||void 0!==t.header){e.next=4;break}throw new $('Flattened JWS must have either of the "protected" or "header" members');case 4:if(void 0===t.protected||"string"===typeof t.protected){e.next=6;break}throw new $("JWS Protected Header incorrect type");case 6:if(void 0!==t.payload){e.next=8;break}throw new $("JWS Payload missing");case 8:if("string"===typeof t.signature){e.next=10;break}throw new $("JWS Signature missing or incorrect type");case 10:if(void 0===t.header||Ve(t.header)){e.next=12;break}throw new $("JWS Unprotected Header incorrect type");case 12:if(o={},!t.protected){e.next=22;break}e.prev=14,i=P(t.protected),o=JSON.parse(y.decode(i)),e.next=22;break;case 19:throw e.prev=19,e.t0=e["catch"](14),new $("JWS Protected Header is invalid");case 22:if(Ge(o,t.header)){e.next=24;break}throw new $("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");case 24:if(c=Io(Io({},o),t.header),u=zn($,new Map([["b64",!0]]),null===n||void 0===n?void 0:n.crit,o,c),s=!0,!u.has("b64")){e.next=31;break}if(s=o.b64,"boolean"===typeof s){e.next=31;break}throw new $('The "b64" (base64url-encode payload) Header Parameter must be a boolean');case 31:if(p=c.alg,"string"===typeof p&&p){e.next=34;break}throw new $('JWS "alg" (Algorithm) Header Parameter missing or invalid');case 34:if(f=n&&$n("algorithms",n.algorithms),!f||f.has(p)){e.next=37;break}throw new F('"alg" (Algorithm) Header Parameter value not allowed');case 37:if(!s){e.next=42;break}if("string"===typeof t.payload){e.next=40;break}throw new $("JWS Payload must be a string");case 40:e.next=44;break;case 42:if("string"===typeof t.payload||t.payload instanceof Uint8Array){e.next=44;break}throw new $("JWS Payload must be a string or an Uint8Array instance");case 44:if(l=!1,"function"!==typeof r){e.next=57;break}return e.next=48,r(o,t);case 48:if(r=e.sent,l=!0,dn(p,r,"verify"),!Vt(r)){e.next=55;break}return e.next=54,Qr(r,p);case 54:r=e.sent;case 55:e.next=58;break;case 57:dn(p,r,"verify");case 58:h=v(d.encode(null!==(a=t.protected)&&void 0!==a?a:""),d.encode("."),"string"===typeof t.payload?d.encode(t.payload):t.payload),e.prev=59,b=P(t.signature),e.next=66;break;case 63:throw e.prev=63,e.t1=e["catch"](59),new $("Failed to base64url decode the signature");case 66:return e.next=68,Wo(p,r,b,h);case 68:if(w=e.sent,w){e.next=71;break}throw new re;case 71:if(!s){e.next=81;break}e.prev=72,m=P(t.payload),e.next=79;break;case 76:throw e.prev=76,e.t2=e["catch"](72),new $("Failed to base64url decode the payload");case 79:e.next=82;break;case 81:m="string"===typeof t.payload?d.encode(t.payload):t.payload;case 82:if(g={payload:m},void 0!==t.protected&&(g.protectedHeader=o),void 0!==t.header&&(g.unprotectedHeader=t.header),!l){e.next=87;break}return e.abrupt("return",Io(Io({},g),{},{key:r}));case 87:return e.abrupt("return",g);case 88:case"end":return e.stop()}}),e,null,[[14,19],[59,63],[72,76]])}))),No.apply(this,arguments)}function Bo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Go(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Bo(Object(r),!0).forEach((function(t){Lo(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Lo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fo(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Vo(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Fo(o,n,a,i,c,"next",e)}function c(e){Fo(o,n,a,i,c,"throw",e)}i(void 0)}))}}function zo(e,t,r){return Xo.apply(this,arguments)}function Xo(){return Xo=Vo(regeneratorRuntime.mark((function e(t,r,n){var a,o,i,c,u,s,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t instanceof Uint8Array&&(t=y.decode(t)),"string"===typeof t){e.next=3;break}throw new $("Compact JWS must be a string or Uint8Array");case 3:if(a=t.split("."),o=a[0],i=a[1],c=a[2],u=a.length,3===u){e.next=6;break}throw new $("Invalid Compact JWS");case 6:return e.next=8,Mo({payload:i,protected:o,signature:c},r,n);case 8:if(s=e.sent,p={payload:s.payload,protectedHeader:s.protectedHeader},"function"!==typeof r){e.next=12;break}return e.abrupt("return",Go(Go({},p),{},{key:s.key}));case 12:return e.abrupt("return",p);case 13:case"end":return e.stop()}}),e)}))),Xo.apply(this,arguments)}function $o(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Yo(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function Yo(e,t){if(e){if("string"===typeof e)return qo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qo(e,t):void 0}}function qo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qo(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Zo(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Qo(o,n,a,i,c,"next",e)}function c(e){Qo(o,n,a,i,c,"throw",e)}i(void 0)}))}}function ei(e,t,r){return ti.apply(this,arguments)}function ti(){return ti=Zo(regeneratorRuntime.mark((function e(t,r,n){var a,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Ve(t)){e.next=2;break}throw new $("General JWS must be an object");case 2:if(Array.isArray(t.signatures)&&t.signatures.every(Ve)){e.next=4;break}throw new $("JWS Signatures missing or incorrect type");case 4:a=$o(t.signatures),e.prev=5,a.s();case 7:if((o=a.n()).done){e.next=19;break}return i=o.value,e.prev=9,e.next=12,Mo({header:i.header,payload:t.payload,protected:i.protected,signature:i.signature},r,n);case 12:return e.abrupt("return",e.sent);case 15:e.prev=15,e.t0=e["catch"](9);case 17:e.next=7;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e["catch"](5),a.e(e.t1);case 24:return e.prev=24,a.f(),e.finish(24);case 27:throw new re;case 28:case"end":return e.stop()}}),e,null,[[5,21,24,27],[9,15]])}))),ti.apply(this,arguments)}var ri=function(e){return Math.floor(e.getTime()/1e3)},ni=60,ai=60*ni,oi=24*ai,ii=7*oi,ci=365.25*oi,ui=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,si=function(e){var t=ui.exec(e);if(!t||t[4]&&t[1])throw new TypeError("Invalid time period format");var r,n=parseFloat(t[2]),a=t[3].toLowerCase();switch(a){case"sec":case"secs":case"second":case"seconds":case"s":r=Math.round(n);break;case"minute":case"minutes":case"min":case"mins":case"m":r=Math.round(n*ni);break;case"hour":case"hours":case"hr":case"hrs":case"h":r=Math.round(n*ai);break;case"day":case"days":case"d":r=Math.round(n*oi);break;case"week":case"weeks":case"w":r=Math.round(n*ii);break;default:r=Math.round(n*ci);break}return"-"===t[1]||"ago"===t[4]?-r:r};function pi(e){return pi="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pi(e)}function fi(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=yi(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function li(e){return vi(e)||hi(e)||yi(e)||di()}function di(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function yi(e,t){if(e){if("string"===typeof e)return bi(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?bi(e,t):void 0}}function hi(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function vi(e){if(Array.isArray(e))return bi(e)}function bi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var wi=function(e){return e.toLowerCase().replace(/^application\//,"")},mi=function(e,t){return"string"===typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)))},gi=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{r=JSON.parse(y.decode(t))}catch(k){}if(!Ve(r))throw new Y("JWT Claims Set must be a top-level JSON object");var a=n.typ;if(a&&("string"!==typeof e.typ||wi(e.typ)!==wi(a)))throw new G('unexpected "typ" JWT header value',r,"typ","check_failed");var o=n.requiredClaims,i=void 0===o?[]:o,c=n.issuer,u=n.subject,s=n.audience,p=n.maxTokenAge,f=li(i);void 0!==p&&f.push("iat"),void 0!==s&&f.push("aud"),void 0!==u&&f.push("sub"),void 0!==c&&f.push("iss");var l,d,h=fi(new Set(f.reverse()));try{for(h.s();!(l=h.n()).done;){var v=l.value;if(!(v in r))throw new G('missing required "'.concat(v,'" claim'),r,v,"missing")}}catch(S){h.e(S)}finally{h.f()}if(c&&!(Array.isArray(c)?c:[c]).includes(r.iss))throw new G('unexpected "iss" claim value',r,"iss","check_failed");if(u&&r.sub!==u)throw new G('unexpected "sub" claim value',r,"sub","check_failed");if(s&&!mi(r.aud,"string"===typeof s?[s]:s))throw new G('unexpected "aud" claim value',r,"aud","check_failed");switch(pi(n.clockTolerance)){case"string":d=si(n.clockTolerance);break;case"number":d=n.clockTolerance;break;case"undefined":d=0;break;default:throw new TypeError("Invalid clockTolerance option type")}var b=n.currentDate,w=ri(b||new Date);if((void 0!==r.iat||p)&&"number"!==typeof r.iat)throw new G('"iat" claim must be a number',r,"iat","invalid");if(void 0!==r.nbf){if("number"!==typeof r.nbf)throw new G('"nbf" claim must be a number',r,"nbf","invalid");if(r.nbf>w+d)throw new G('"nbf" claim timestamp check failed',r,"nbf","check_failed")}if(void 0!==r.exp){if("number"!==typeof r.exp)throw new G('"exp" claim must be a number',r,"exp","invalid");if(r.exp<=w-d)throw new L('"exp" claim timestamp check failed',r,"exp","check_failed")}if(p){var m=w-r.iat,g="number"===typeof p?p:si(p);if(m-d>g)throw new L('"iat" claim timestamp check failed (too far in the past)',r,"iat","check_failed");if(m<0-d)throw new G('"iat" claim timestamp check failed (it should be in the past)',r,"iat","check_failed")}return r};function ki(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Si(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ki(Object(r),!0).forEach((function(t){Ai(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ki(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ai(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ei(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function xi(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ei(o,n,a,i,c,"next",e)}function c(e){Ei(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Oi(e,t,r){return Pi.apply(this,arguments)}function Pi(){return Pi=xi(regeneratorRuntime.mark((function e(t,r,n){var a,o,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,zo(t,r,n);case 2:if(o=e.sent,null===(a=o.protectedHeader.crit)||void 0===a||!a.includes("b64")||!1!==o.protectedHeader.b64){e.next=5;break}throw new Y("JWTs MUST NOT use unencoded payload");case 5:if(i=gi(o.protectedHeader,o.payload,n),c={payload:i,protectedHeader:o.protectedHeader},"function"!==typeof r){e.next=9;break}return e.abrupt("return",Si(Si({},c),{},{key:o.key}));case 9:return e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)}))),Pi.apply(this,arguments)}function ji(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ji(Object(r),!0).forEach((function(t){Ri(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ji(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ri(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hi(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Ci(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Hi(o,n,a,i,c,"next",e)}function c(e){Hi(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Ki(e,t,r){return Wi.apply(this,arguments)}function Wi(){return Wi=Ci(regeneratorRuntime.mark((function e(t,r,n){var a,o,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ua(t,r,n);case 2:if(a=e.sent,o=gi(a.protectedHeader,a.plaintext,n),i=a.protectedHeader,void 0===i.iss||i.iss===o.iss){e.next=7;break}throw new G('replicated "iss" claim header parameter mismatch',o,"iss","mismatch");case 7:if(void 0===i.sub||i.sub===o.sub){e.next=9;break}throw new G('replicated "sub" claim header parameter mismatch',o,"sub","mismatch");case 9:if(void 0===i.aud||JSON.stringify(i.aud)===JSON.stringify(o.aud)){e.next=11;break}throw new G('replicated "aud" claim header parameter mismatch',o,"aud","mismatch");case 11:if(c={payload:o,protectedHeader:i},"function"!==typeof r){e.next=14;break}return e.abrupt("return",_i(_i({},c),{},{key:a.key}));case 14:return e.abrupt("return",c);case 15:case"end":return e.stop()}}),e)}))),Wi.apply(this,arguments)}function Ti(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Ii(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ti(o,n,a,i,c,"next",e)}function c(e){Ti(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Ji(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Di(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ui(e,t,r){return t&&Di(e.prototype,t),r&&Di(e,r),e}var Mi=function(){function e(t){Ji(this,e),this._flattened=new ro(t)}return Ui(e,[{key:"setContentEncryptionKey",value:function(e){return this._flattened.setContentEncryptionKey(e),this}},{key:"setInitializationVector",value:function(e){return this._flattened.setInitializationVector(e),this}},{key:"setProtectedHeader",value:function(e){return this._flattened.setProtectedHeader(e),this}},{key:"setKeyManagementParameters",value:function(e){return this._flattened.setKeyManagementParameters(e),this}},{key:"encrypt",value:function(){var e=Ii(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._flattened.encrypt(t,r);case 2:return n=e.sent,e.abrupt("return",[n.protected,n.encrypted_key,n.iv,n.ciphertext,n.tag].join("."));case 4:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}();function Ni(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Bi(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ni(o,n,a,i,c,"next",e)}function c(e){Ni(o,n,a,i,c,"throw",e)}i(void 0)}))}}var Gi=function(){var e=Bi(regeneratorRuntime.mark((function e(t,r,n){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_o(t,r,"sign");case 2:return a=e.sent,Tt(t,a),e.next=6,o.subtle.sign(go(t,a.algorithm),a,n);case 6:return i=e.sent,e.abrupt("return",new Uint8Array(i));case 8:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),Li=Gi;function Fi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Vi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fi(Object(r),!0).forEach((function(t){zi(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function zi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xi(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function $i(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Xi(o,n,a,i,c,"next",e)}function c(e){Xi(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Yi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qi(e,t,r){return t&&qi(e.prototype,t),r&&qi(e,r),e}var Zi=function(){function e(t){if(Yi(this,e),!(t instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=t}return Qi(e,[{key:"setProtectedHeader",value:function(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}},{key:"setUnprotectedHeader",value:function(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}},{key:"sign",value:function(){var e=$i(regeneratorRuntime.mark((function e(t,r){var n,a,o,i,c,u,s,p,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this._protectedHeader||this._unprotectedHeader){e.next=2;break}throw new $("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");case 2:if(Ge(this._protectedHeader,this._unprotectedHeader)){e.next=4;break}throw new $("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");case 4:if(n=Vi(Vi({},this._protectedHeader),this._unprotectedHeader),a=zn($,new Map([["b64",!0]]),null===r||void 0===r?void 0:r.crit,this._protectedHeader,n),o=!0,!a.has("b64")){e.next=11;break}if(o=this._protectedHeader.b64,"boolean"===typeof o){e.next=11;break}throw new $('The "b64" (base64url-encode payload) Header Parameter must be a boolean');case 11:if(i=n.alg,"string"===typeof i&&i){e.next=14;break}throw new $('JWS "alg" (Algorithm) Header Parameter missing or invalid');case 14:return dn(i,t,"sign"),c=this._payload,o&&(c=d.encode(x(c))),u=this._protectedHeader?d.encode(x(JSON.stringify(this._protectedHeader))):d.encode(""),s=v(u,d.encode("."),c),e.next=21,Li(i,t,s);case 21:return p=e.sent,f={signature:x(p),payload:""},o&&(f.payload=y.decode(c)),this._unprotectedHeader&&(f.header=this._unprotectedHeader),this._protectedHeader&&(f.protected=y.decode(u)),e.abrupt("return",f);case 27:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}();function ec(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function tc(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){ec(o,n,a,i,c,"next",e)}function c(e){ec(o,n,a,i,c,"throw",e)}i(void 0)}))}}function rc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ac(e,t,r){return t&&nc(e.prototype,t),r&&nc(e,r),e}var oc=function(){function e(t){rc(this,e),this._flattened=new Zi(t)}return ac(e,[{key:"setProtectedHeader",value:function(e){return this._flattened.setProtectedHeader(e),this}},{key:"sign",value:function(){var e=tc(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._flattened.sign(t,r);case 2:if(n=e.sent,void 0!==n.payload){e.next=5;break}throw new TypeError("use the flattened module for creating JWS with b64: false");case 5:return e.abrupt("return","".concat(n.protected,".").concat(n.payload,".").concat(n.signature));case 6:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}(),ic=["payload"];function cc(e,t){if(null==e)return{};var r,n,a=uc(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uc(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}function sc(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function pc(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){sc(o,n,a,i,c,"next",e)}function c(e){sc(o,n,a,i,c,"throw",e)}i(void 0)}))}}function fc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dc(e,t,r){return t&&lc(e.prototype,t),r&&lc(e,r),e}var yc=function(){function e(t,r,n){fc(this,e),this.parent=t,this.key=r,this.options=n}return dc(e,[{key:"setProtectedHeader",value:function(e){if(this.protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this.protectedHeader=e,this}},{key:"setUnprotectedHeader",value:function(e){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}},{key:"addSignature",value:function(){var e;return(e=this.parent).addSignature.apply(e,arguments)}},{key:"sign",value:function(){var e;return(e=this.parent).sign.apply(e,arguments)}},{key:"done",value:function(){return this.parent}}]),e}(),hc=function(){function e(t){fc(this,e),this._signatures=[],this._payload=t}return dc(e,[{key:"addSignature",value:function(e,t){var r=new yc(this,e,t);return this._signatures.push(r),r}},{key:"sign",value:function(){var e=pc(regeneratorRuntime.mark((function e(){var t,r,n,a,o,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this._signatures.length){e.next=2;break}throw new $("at least one signature must be added");case 2:t={signatures:[],payload:""},r=0;case 4:if(!(r<this._signatures.length)){e.next=24;break}return n=this._signatures[r],a=new Zi(this._payload),a.setProtectedHeader(n.protectedHeader),a.setUnprotectedHeader(n.unprotectedHeader),e.next=11,a.sign(n.key,n.options);case 11:if(o=e.sent,i=o.payload,c=cc(o,ic),0!==r){e.next=18;break}t.payload=i,e.next=20;break;case 18:if(t.payload===i){e.next=20;break}throw new $("inconsistent use of JWS Unencoded Payload (RFC7797)");case 20:t.signatures.push(c);case 21:r++,e.next=4;break;case 24:return e.abrupt("return",t);case 25:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}();function vc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function bc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vc(Object(r),!0).forEach((function(t){wc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function wc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kc(e,t,r){return t&&gc(e.prototype,t),r&&gc(e,r),e}function Sc(e,t){if(!Number.isFinite(t))throw new TypeError("Invalid ".concat(e," input"));return t}var Ac=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(mc(this,e),!Ve(t))throw new TypeError("JWT Claims Set MUST be an object");this._payload=t}return kc(e,[{key:"setIssuer",value:function(e){return this._payload=bc(bc({},this._payload),{},{iss:e}),this}},{key:"setSubject",value:function(e){return this._payload=bc(bc({},this._payload),{},{sub:e}),this}},{key:"setAudience",value:function(e){return this._payload=bc(bc({},this._payload),{},{aud:e}),this}},{key:"setJti",value:function(e){return this._payload=bc(bc({},this._payload),{},{jti:e}),this}},{key:"setNotBefore",value:function(e){return"number"===typeof e?this._payload=bc(bc({},this._payload),{},{nbf:Sc("setNotBefore",e)}):e instanceof Date?this._payload=bc(bc({},this._payload),{},{nbf:Sc("setNotBefore",ri(e))}):this._payload=bc(bc({},this._payload),{},{nbf:ri(new Date)+si(e)}),this}},{key:"setExpirationTime",value:function(e){return"number"===typeof e?this._payload=bc(bc({},this._payload),{},{exp:Sc("setExpirationTime",e)}):e instanceof Date?this._payload=bc(bc({},this._payload),{},{exp:Sc("setExpirationTime",ri(e))}):this._payload=bc(bc({},this._payload),{},{exp:ri(new Date)+si(e)}),this}},{key:"setIssuedAt",value:function(e){return"undefined"===typeof e?this._payload=bc(bc({},this._payload),{},{iat:ri(new Date)}):e instanceof Date?this._payload=bc(bc({},this._payload),{},{iat:Sc("setIssuedAt",ri(e))}):this._payload=bc(bc({},this._payload),{},"string"===typeof e?{iat:Sc("setIssuedAt",ri(new Date)+si(e))}:{iat:Sc("setIssuedAt",e)}),this}}]),e}();function Ec(e){return Ec="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ec(e)}function xc(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Oc(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){xc(o,n,a,i,c,"next",e)}function c(e){xc(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Pc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _c(e,t,r){return t&&jc(e.prototype,t),r&&jc(e,r),e}function Rc(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hc(e,t)}function Hc(e,t){return Hc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Hc(e,t)}function Cc(e){var t=Tc();return function(){var r,n=Ic(e);if(t){var a=Ic(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Kc(this,r)}}function Kc(e,t){if(t&&("object"===Ec(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Wc(e)}function Wc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tc(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ic(e){return Ic=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ic(e)}var Jc=function(e){Rc(r,e);var t=Cc(r);function r(){return Pc(this,r),t.apply(this,arguments)}return _c(r,[{key:"setProtectedHeader",value:function(e){return this._protectedHeader=e,this}},{key:"sign",value:function(){var e=Oc(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=new oc(d.encode(JSON.stringify(this._payload))),a.setProtectedHeader(this._protectedHeader),!Array.isArray(null===(n=this._protectedHeader)||void 0===n?void 0:n.crit)||!this._protectedHeader.crit.includes("b64")||!1!==this._protectedHeader.b64){e.next=4;break}throw new Y("JWTs MUST NOT use unencoded payload");case 4:return e.abrupt("return",a.sign(t,r));case 5:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),r}(Ac);function Dc(e){return Dc="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dc(e)}function Uc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Uc(Object(r),!0).forEach((function(t){Nc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Nc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bc(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Gc(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Bc(o,n,a,i,c,"next",e)}function c(e){Bc(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Lc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vc(e,t,r){return t&&Fc(e.prototype,t),r&&Fc(e,r),e}function zc(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xc(e,t)}function Xc(e,t){return Xc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Xc(e,t)}function $c(e){var t=Qc();return function(){var r,n=Zc(e);if(t){var a=Zc(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Yc(this,r)}}function Yc(e,t){if(t&&("object"===Dc(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return qc(e)}function qc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qc(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Zc(e){return Zc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zc(e)}var eu=function(e){zc(r,e);var t=$c(r);function r(){return Lc(this,r),t.apply(this,arguments)}return Vc(r,[{key:"setProtectedHeader",value:function(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}},{key:"setKeyManagementParameters",value:function(e){if(this._keyManagementParameters)throw new TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}},{key:"setContentEncryptionKey",value:function(e){if(this._cek)throw new TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}},{key:"setInitializationVector",value:function(e){if(this._iv)throw new TypeError("setInitializationVector can only be called once");return this._iv=e,this}},{key:"replicateIssuerAsHeader",value:function(){return this._replicateIssuerAsHeader=!0,this}},{key:"replicateSubjectAsHeader",value:function(){return this._replicateSubjectAsHeader=!0,this}},{key:"replicateAudienceAsHeader",value:function(){return this._replicateAudienceAsHeader=!0,this}},{key:"encrypt",value:function(){var e=Gc(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new Mi(d.encode(JSON.stringify(this._payload))),this._replicateIssuerAsHeader&&(this._protectedHeader=Mc(Mc({},this._protectedHeader),{},{iss:this._payload.iss})),this._replicateSubjectAsHeader&&(this._protectedHeader=Mc(Mc({},this._protectedHeader),{},{sub:this._payload.sub})),this._replicateAudienceAsHeader&&(this._protectedHeader=Mc(Mc({},this._protectedHeader),{},{aud:this._payload.aud})),n.setProtectedHeader(this._protectedHeader),this._iv&&n.setInitializationVector(this._iv),this._cek&&n.setContentEncryptionKey(this._cek),this._keyManagementParameters&&n.setKeyManagementParameters(this._keyManagementParameters),e.abrupt("return",n.encrypt(t,r));case 9:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),r}(Ac);function tu(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function ru(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){tu(o,n,a,i,c,"next",e)}function c(e){tu(o,n,a,i,c,"throw",e)}i(void 0)}))}}var nu=function(e,t){if("string"!==typeof e||!e)throw new q("".concat(t," missing or invalid"))};function au(e,t){return ou.apply(this,arguments)}function ou(){return ou=ru(regeneratorRuntime.mark((function e(t,r){var n,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Ve(t)){e.next=2;break}throw new TypeError("JWK must be an object");case 2:if(null!==(n=r)&&void 0!==n||(r="sha256"),"sha256"===r||"sha384"===r||"sha512"===r){e.next=5;break}throw new TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');case 5:e.t0=t.kty,e.next="EC"===e.t0?8:"OKP"===e.t0?13:"RSA"===e.t0?17:"oct"===e.t0?21:24;break;case 8:return nu(t.crv,'"crv" (Curve) Parameter'),nu(t.x,'"x" (X Coordinate) Parameter'),nu(t.y,'"y" (Y Coordinate) Parameter'),a={crv:t.crv,kty:t.kty,x:t.x,y:t.y},e.abrupt("break",25);case 13:return nu(t.crv,'"crv" (Subtype of Key Pair) Parameter'),nu(t.x,'"x" (Public Key) Parameter'),a={crv:t.crv,kty:t.kty,x:t.x},e.abrupt("break",25);case 17:return nu(t.e,'"e" (Exponent) Parameter'),nu(t.n,'"n" (Modulus) Parameter'),a={e:t.e,kty:t.kty,n:t.n},e.abrupt("break",25);case 21:return nu(t.k,'"k" (Key Value) Parameter'),a={k:t.k,kty:t.kty},e.abrupt("break",25);case 24:throw new V('"kty" (Key Type) Parameter missing or unsupported');case 25:return o=d.encode(JSON.stringify(a)),e.t1=x,e.next=29,p(r,o);case 29:return e.t2=e.sent,e.abrupt("return",(0,e.t1)(e.t2));case 31:case"end":return e.stop()}}),e)}))),ou.apply(this,arguments)}function iu(e,t){return cu.apply(this,arguments)}function cu(){return cu=ru(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return null!==(n=r)&&void 0!==n||(r="sha256"),e.next=3,au(t,r);case 3:return a=e.sent,e.abrupt("return","urn:ietf:params:oauth:jwk-thumbprint:sha-".concat(r.slice(-3),":").concat(a));case 5:case"end":return e.stop()}}),e)}))),cu.apply(this,arguments)}function uu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function su(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?uu(Object(r),!0).forEach((function(t){pu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function pu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fu(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function lu(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){fu(o,n,a,i,c,"next",e)}function c(e){fu(o,n,a,i,c,"throw",e)}i(void 0)}))}}function du(e,t){return yu.apply(this,arguments)}function yu(){return yu=lu(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=su(su({},t),null===r||void 0===r?void 0:r.header),Ve(n.jwk)){e.next=3;break}throw new $('"jwk" (JSON Web Key) Header Parameter must be a JSON object');case 3:return e.next=5,Qr(su(su({},n.jwk),{},{ext:!0}),n.alg);case 5:if(a=e.sent,!(a instanceof Uint8Array||"public"!==a.type)){e.next=8;break}throw new $('"jwk" (JSON Web Key) Header Parameter must be a public key');case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)}))),yu.apply(this,arguments)}function hu(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=vu(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function vu(e,t){if(e){if("string"===typeof e)return bu(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?bu(e,t):void 0}}function bu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function mu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wu(Object(r),!0).forEach((function(t){gu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function gu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ku(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Su(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){ku(o,n,a,i,c,"next",e)}function c(e){ku(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Au(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Eu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xu(e,t,r){return t&&Eu(e.prototype,t),r&&Eu(e,r),e}function Ou(e){return Ou="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ou(e)}function Pu(e){return new Ru(e)}function ju(e){return function(){return new _u(e.apply(this,arguments))}}function _u(e){var t,r;function n(e,n){return new Promise((function(o,i){var c={key:e,arg:n,resolve:o,reject:i,next:null};r?r=r.next=c:(t=r=c,a(e,n))}))}function a(t,r){try{var n=e[t](r),i=n.value,c=i instanceof Ru;Promise.resolve(c?i.wrapped:i).then((function(e){c?a("return"===t?"return":"next",e):o(n.done?"return":"normal",e)}),(function(e){a("throw",e)}))}catch(u){o("throw",u)}}function o(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1});break}t=t.next,t?a(t.key,t.arg):r=null}this._invoke=n,"function"!==typeof e.return&&(this.return=void 0)}function Ru(e){this.wrapped=e}function Hu(e){switch("string"===typeof e&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new V('Unsupported "alg" value for a JSON Web Key Set')}}function Cu(e){return e&&"object"===Ou(e)&&Array.isArray(e.keys)&&e.keys.every(Ku)}function Ku(e){return Ve(e)}function Wu(e){return"function"===typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}_u.prototype["function"===typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},_u.prototype.next=function(e){return this._invoke("next",e)},_u.prototype.throw=function(e){return this._invoke("throw",e)},_u.prototype.return=function(e){return this._invoke("return",e)};var Tu=function(){function e(t){if(Au(this,e),this._cached=new WeakMap,!Cu(t))throw new Q("JSON Web Key Set malformed");this._jwks=Wu(t)}return xu(e,[{key:"getKey",value:function(){var e=Su(regeneratorRuntime.mark((function e(t,r){var n,a,o,i,c,u,s,p,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=mu(mu({},t),null===r||void 0===r?void 0:r.header),a=n.alg,o=n.kid,i=Hu(a),c=this._jwks.keys.filter((function(e){var t=i===e.kty;if(t&&"string"===typeof o&&(t=o===e.kid),t&&"string"===typeof e.alg&&(t=a===e.alg),t&&"string"===typeof e.use&&(t="sig"===e.use),t&&Array.isArray(e.key_ops)&&(t=e.key_ops.includes("verify")),t&&"EdDSA"===a&&(t="Ed25519"===e.crv||"Ed448"===e.crv),t)switch(a){case"ES256":t="P-256"===e.crv;break;case"ES256K":t="secp256k1"===e.crv;break;case"ES384":t="P-384"===e.crv;break;case"ES512":t="P-521"===e.crv;break}return t})),u=c[0],s=c.length,0!==s){e.next=6;break}throw new Z;case 6:if(1===s){e.next=11;break}throw p=new ee,f=this._cached,p[Symbol.asyncIterator]=ju(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=hu(c),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=16;break}return n=r.value,e.prev=5,e.next=8,Pu(Iu(f,n,a));case 8:return e.next=10,e.sent;case 10:e.next=14;break;case 12:e.prev=12,e.t0=e["catch"](5);case 14:e.next=3;break;case 16:e.next=21;break;case 18:e.prev=18,e.t1=e["catch"](1),t.e(e.t1);case 21:return e.prev=21,t.f(),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[1,18,21,24],[5,12]])}))),p;case 11:return e.abrupt("return",Iu(this._cached,u,a));case 12:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}();function Iu(e,t,r){return Ju.apply(this,arguments)}function Ju(){return Ju=Su(regeneratorRuntime.mark((function e(t,r,n){var a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.get(r)||t.set(r,{}).get(r),void 0!==a[n]){e.next=8;break}return e.next=4,Qr(mu(mu({},r),{},{ext:!0}),n);case 4:if(o=e.sent,!(o instanceof Uint8Array||"public"!==o.type)){e.next=7;break}throw new Q("JSON Web Key Set members must be public keys");case 7:a[n]=o;case 8:return e.abrupt("return",a[n]);case 9:case"end":return e.stop()}}),e)}))),Ju.apply(this,arguments)}function Du(e){var t=new Tu(e),r=function(){var e=Su(regeneratorRuntime.mark((function e(r,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.getKey(r,n));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return Object.defineProperties(r,{jwks:{value:function(){return Wu(t._jwks)},enumerable:!0,configurable:!1,writable:!1}}),r}function Uu(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Mu(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Uu(o,n,a,i,c,"next",e)}function c(e){Uu(o,n,a,i,c,"throw",e)}i(void 0)}))}}var Nu,Bu,Gu,Lu=function(){var e=Mu(regeneratorRuntime.mark((function e(t,r,n){var a,o,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=!1,"function"===typeof AbortController&&(a=new AbortController,o=setTimeout((function(){i=!0,a.abort()}),r)),e.next=4,fetch(t.href,{signal:a?a.signal:void 0,redirect:"manual",headers:n.headers}).catch((function(e){if(i)throw new te;throw e}));case 4:if(c=e.sent,void 0!==o&&clearTimeout(o),200===c.status){e.next=8;break}throw new B("Expected 200 OK from the JSON Web Key Set HTTP response");case 8:return e.prev=8,e.next=11,c.json();case 11:return e.abrupt("return",e.sent);case 14:throw e.prev=14,e.t0=e["catch"](8),new B("Failed to parse the JSON Web Key Set HTTP response as JSON");case 17:case"end":return e.stop()}}),e,null,[[8,14]])})));return function(t,r,n){return e.apply(this,arguments)}}(),Fu=Lu;function Vu(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function zu(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Vu(o,n,a,i,c,"next",e)}function c(e){Vu(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Xu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yu(e,t,r){return t&&$u(e.prototype,t),r&&$u(e,r),e}function qu(e){return qu="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qu(e)}function Qu(){return"undefined"!==typeof WebSocketPair||"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!==typeof EdgeRuntime&&"vercel"===EdgeRuntime}if("undefined"===typeof navigator||null===(Nu=navigator.userAgent)||void 0===Nu||null===(Bu=Nu.startsWith)||void 0===Bu||!Bu.call(Nu,"Mozilla/5.0 ")){var Zu="jose",es="v5.9.6";Gu="".concat(Zu,"/").concat(es)}var ts=Symbol();function rs(e,t){return"object"===qu(e)&&null!==e&&("uat"in e&&"number"===typeof e.uat&&!(Date.now()-e.uat>=t)&&!!("jwks"in e&&Ve(e.jwks)&&Array.isArray(e.jwks.keys)&&Array.prototype.every.call(e.jwks.keys,Ve)))}var ns=function(){function e(t,r){if(Xu(this,e),!(t instanceof URL))throw new TypeError("url must be an instance of URL");this._url=new URL(t.href),this._options={agent:null===r||void 0===r?void 0:r.agent,headers:null===r||void 0===r?void 0:r.headers},this._timeoutDuration="number"===typeof(null===r||void 0===r?void 0:r.timeoutDuration)?null===r||void 0===r?void 0:r.timeoutDuration:5e3,this._cooldownDuration="number"===typeof(null===r||void 0===r?void 0:r.cooldownDuration)?null===r||void 0===r?void 0:r.cooldownDuration:3e4,this._cacheMaxAge="number"===typeof(null===r||void 0===r?void 0:r.cacheMaxAge)?null===r||void 0===r?void 0:r.cacheMaxAge:6e5,void 0!==(null===r||void 0===r?void 0:r[ts])&&(this._cache=null===r||void 0===r?void 0:r[ts],rs(null===r||void 0===r?void 0:r[ts],this._cacheMaxAge)&&(this._jwksTimestamp=this._cache.uat,this._local=Du(this._cache.jwks)))}return Yu(e,[{key:"coolingDown",value:function(){return"number"===typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}},{key:"fresh",value:function(){return"number"===typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}},{key:"getKey",value:function(){var e=zu(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this._local&&this.fresh()){e.next=3;break}return e.next=3,this.reload();case 3:return e.prev=3,e.next=6,this._local(t,r);case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e["catch"](3),!(e.t0 instanceof Z)){e.next=16;break}if(!1!==this.coolingDown()){e.next=16;break}return e.next=15,this.reload();case 15:return e.abrupt("return",this._local(t,r));case 16:throw e.t0;case 17:case"end":return e.stop()}}),e,this,[[3,9]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"reload",value:function(){var e=zu(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this._pendingFetch&&Qu()&&(this._pendingFetch=void 0),t=new Headers(this._options.headers),Gu&&!t.has("User-Agent")&&(t.set("User-Agent",Gu),this._options.headers=Object.fromEntries(t.entries())),this._pendingFetch||(this._pendingFetch=Fu(this._url,this._timeoutDuration,this._options).then((function(e){r._local=Du(e),r._cache&&(r._cache.uat=Date.now(),r._cache.jwks=e),r._jwksTimestamp=Date.now(),r._pendingFetch=void 0})).catch((function(e){throw r._pendingFetch=void 0,e}))),e.next=6,this._pendingFetch;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}();function as(e,t){var r=new ns(e,t),n=function(){var e=zu(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",r.getKey(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return Object.defineProperties(n,{coolingDown:{get:function(){return r.coolingDown()},enumerable:!0,configurable:!1},fresh:{get:function(){return r.fresh()},enumerable:!0,configurable:!1},reload:{value:function(){return r.reload()},enumerable:!0,configurable:!1,writable:!1},reloading:{get:function(){return!!r._pendingFetch},enumerable:!0,configurable:!1},jwks:{value:function(){var e;return null===(e=r._local)||void 0===e?void 0:e.jwks()},enumerable:!0,configurable:!1,writable:!1}}),n}var os=ts;function is(e){return is="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},is(e)}function cs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function us(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ss(e,t,r){return t&&us(e.prototype,t),r&&us(e,r),e}function ps(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fs(e,t)}function fs(e,t){return fs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},fs(e,t)}function ls(e){var t=hs();return function(){var r,n=vs(e);if(t){var a=vs(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return ds(this,r)}}function ds(e,t){if(t&&("object"===is(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ys(e)}function ys(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hs(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function vs(e){return vs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},vs(e)}var bs=function(e){ps(r,e);var t=ls(r);function r(){return cs(this,r),t.apply(this,arguments)}return ss(r,[{key:"encode",value:function(){var e=x(JSON.stringify({alg:"none"})),t=x(JSON.stringify(this._payload));return"".concat(e,".").concat(t,".")}}],[{key:"decode",value:function(e,t){if("string"!==typeof e)throw new Y("Unsecured JWT must be a string");var r,n=e.split("."),a=n[0],o=n[1],i=n[2],c=n.length;if(3!==c||""!==i)throw new Y("Invalid Unsecured JWT");try{if(r=JSON.parse(y.decode(P(a))),"none"!==r.alg)throw new Error}catch(s){throw new Y("Invalid Unsecured JWT")}var u=gi(r,P(o),t);return{payload:u,header:r}}}]),r}(Ac),ws=x,ms=P;function gs(e){return gs="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gs(e)}function ks(e,t){return Os(e)||xs(e,t)||As(e,t)||Ss()}function Ss(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function As(e,t){if(e){if("string"===typeof e)return Es(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Es(e,t):void 0}}function Es(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xs(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done);i=!0)if(o.push(n.value),t&&o.length===t)break}catch(u){c=!0,a=u}finally{try{i||null==r["return"]||r["return"]()}finally{if(c)throw a}}return o}}function Os(e){if(Array.isArray(e))return e}function Ps(e){var t;if("string"===typeof e){var r=e.split(".");if(3===r.length||5===r.length){var n=ks(r,1);t=n[0]}}else if("object"===gs(e)&&e){if(!("protected"in e))throw new TypeError("Token does not contain a Protected Header");t=e.protected}try{if("string"!==typeof t||!t)throw new Error;var a=JSON.parse(y.decode(ms(t)));if(!Ve(a))throw new Error;return a}catch(o){throw new TypeError("Invalid Token or Protected Header formatting")}}function js(e){if("string"!==typeof e)throw new Y("JWTs must use Compact JWS serialization, JWT must be a string");var t,r,n=e.split("."),a=n[1],o=n.length;if(5===o)throw new Y("Only JWTs using Compact JWS serialization can be decoded");if(3!==o)throw new Y("Invalid JWT");if(!a)throw new Y("JWTs must contain a payload");try{t=ms(a)}catch(i){throw new Y("Failed to base64url decode the payload")}try{r=JSON.parse(y.decode(t))}catch(c){throw new Y("Failed to parse the decoded payload as JSON")}if(!Ve(r))throw new Y("Invalid JWT Claims Set");return r}function _s(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Rs(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){_s(o,n,a,i,c,"next",e)}function c(e){_s(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Hs(e,t){return Cs.apply(this,arguments)}function Cs(){return Cs=Rs(regeneratorRuntime.mark((function e(t,r){var n,a,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=t,e.next="HS256"===e.t0||"HS384"===e.t0||"HS512"===e.t0?3:"A128CBC-HS256"===e.t0||"A192CBC-HS384"===e.t0||"A256CBC-HS512"===e.t0?7:"A128KW"===e.t0||"A192KW"===e.t0||"A256KW"===e.t0?9:"A128GCMKW"===e.t0||"A192GCMKW"===e.t0||"A256GCMKW"===e.t0||"A128GCM"===e.t0||"A192GCM"===e.t0||"A256GCM"===e.t0?13:17;break;case 3:return a=parseInt(t.slice(-3),10),i={name:"HMAC",hash:"SHA-".concat(a),length:a},c=["sign","verify"],e.abrupt("break",18);case 7:return a=parseInt(t.slice(-3),10),e.abrupt("return",ne(new Uint8Array(a>>3)));case 9:return a=parseInt(t.slice(1,4),10),i={name:"AES-KW",length:a},c=["wrapKey","unwrapKey"],e.abrupt("break",18);case 13:return a=parseInt(t.slice(1,4),10),i={name:"AES-GCM",length:a},c=["encrypt","decrypt"],e.abrupt("break",18);case 17:throw new V('Invalid or unsupported JWK "alg" (Algorithm) Parameter value');case 18:return e.abrupt("return",o.subtle.generateKey(i,null!==(n=null===r||void 0===r?void 0:r.extractable)&&void 0!==n&&n,c));case 19:case"end":return e.stop()}}),e)}))),Cs.apply(this,arguments)}function Ks(e){var t,r=null!==(t=null===e||void 0===e?void 0:e.modulusLength)&&void 0!==t?t:2048;if("number"!==typeof r||r<2048)throw new V("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return r}function Ws(e,t){return Ts.apply(this,arguments)}function Ts(){return Ts=Rs(regeneratorRuntime.mark((function e(t,r){var n,a,i,c,u,s,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=t,e.next="PS256"===e.t0||"PS384"===e.t0||"PS512"===e.t0?3:"RS256"===e.t0||"RS384"===e.t0||"RS512"===e.t0?6:"RSA-OAEP"===e.t0||"RSA-OAEP-256"===e.t0||"RSA-OAEP-384"===e.t0||"RSA-OAEP-512"===e.t0?9:"ES256"===e.t0?12:"ES384"===e.t0?15:"ES512"===e.t0?18:"EdDSA"===e.t0?21:"ECDH-ES"===e.t0||"ECDH-ES+A128KW"===e.t0||"ECDH-ES+A192KW"===e.t0||"ECDH-ES+A256KW"===e.t0?30:41;break;case 3:return a={name:"RSA-PSS",hash:"SHA-".concat(t.slice(-3)),publicExponent:new Uint8Array([1,0,1]),modulusLength:Ks(r)},i=["sign","verify"],e.abrupt("break",42);case 6:return a={name:"RSASSA-PKCS1-v1_5",hash:"SHA-".concat(t.slice(-3)),publicExponent:new Uint8Array([1,0,1]),modulusLength:Ks(r)},i=["sign","verify"],e.abrupt("break",42);case 9:return a={name:"RSA-OAEP",hash:"SHA-".concat(parseInt(t.slice(-3),10)||1),publicExponent:new Uint8Array([1,0,1]),modulusLength:Ks(r)},i=["decrypt","unwrapKey","encrypt","wrapKey"],e.abrupt("break",42);case 12:return a={name:"ECDSA",namedCurve:"P-256"},i=["sign","verify"],e.abrupt("break",42);case 15:return a={name:"ECDSA",namedCurve:"P-384"},i=["sign","verify"],e.abrupt("break",42);case 18:return a={name:"ECDSA",namedCurve:"P-521"},i=["sign","verify"],e.abrupt("break",42);case 21:i=["sign","verify"],u=null!==(c=null===r||void 0===r?void 0:r.crv)&&void 0!==c?c:"Ed25519",e.t1=u,e.next="Ed25519"===e.t1||"Ed448"===e.t1?26:28;break;case 26:return a={name:u},e.abrupt("break",29);case 28:throw new V("Invalid or unsupported crv option provided");case 29:return e.abrupt("break",42);case 30:i=["deriveKey","deriveBits"],p=null!==(s=null===r||void 0===r?void 0:r.crv)&&void 0!==s?s:"P-256",e.t2=p,e.next="P-256"===e.t2||"P-384"===e.t2||"P-521"===e.t2?35:"X25519"===e.t2||"X448"===e.t2?37:39;break;case 35:return a={name:"ECDH",namedCurve:p},e.abrupt("break",40);case 37:return a={name:p},e.abrupt("break",40);case 39:throw new V("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448");case 40:return e.abrupt("break",42);case 41:throw new V('Invalid or unsupported JWK "alg" (Algorithm) Parameter value');case 42:return e.abrupt("return",o.subtle.generateKey(a,null!==(n=null===r||void 0===r?void 0:r.extractable)&&void 0!==n&&n,i));case 43:case"end":return e.stop()}}),e)}))),Ts.apply(this,arguments)}function Is(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Js(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Is(o,n,a,i,c,"next",e)}function c(e){Is(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Ds(e,t){return Us.apply(this,arguments)}function Us(){return Us=Js(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Ws(t,r));case 1:case"end":return e.stop()}}),e)}))),Us.apply(this,arguments)}function Ms(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function Ns(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ms(o,n,a,i,c,"next",e)}function c(e){Ms(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Bs(e,t){return Gs.apply(this,arguments)}function Gs(){return Gs=Ns(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Hs(t,r));case 1:case"end":return e.stop()}}),e)}))),Gs.apply(this,arguments)}var Ls="WebCryptoAPI",Fs=Ls}}]);